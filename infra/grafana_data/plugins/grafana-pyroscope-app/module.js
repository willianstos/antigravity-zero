/* [create-plugin] version: 5.25.8 */
define(["@grafana/runtime","rxjs","module","@emotion/css","react-dom","d3","@emotion/react","react-router","@grafana/ui","react","@grafana/data","lodash"],(e,r,o,a,n,t,i,p,l,s,c,d)=>(()=>{"use strict";var u,f,m={18531(r){r.exports=e},31269(e){e.exports=r},41308(e){e.exports=o},46089(e){e.exports=a},48398(e){e.exports=n},74201(e){e.exports=t},79089(e){e.exports=i},81159(e){e.exports=p},82007(e){e.exports=l},85959(e){e.exports=s},87781(e){e.exports=c},93241(e){e.exports=d}},g={};function v(e){var r=g[e];if(void 0!==r)return r.exports;var o=g[e]={id:e,loaded:!1,exports:{}};return m[e].call(o.exports,o,o.exports,v),o.loaded=!0,o.exports}v.m=m,v.amdO={},v.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return v.d(r,{a:r}),r},v.d=(e,r)=>{for(var o in r)v.o(r,o)&&!v.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:r[o]})},v.f={},v.e=e=>Promise.all(Object.keys(v.f).reduce((r,o)=>(v.f[o](e,r),r),[])),v.u=e=>e+".js?_cache="+{72:"87059dc5872caaf6adbb",156:"736d0f1184fbb34185d0",580:"7991f257679a005c16d7",776:"387841e093358c6fb3cc",814:"2f107ff53ea43602646f",909:"6ed622dfc479c8bd7cce"}[e],v.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),v.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),u={},f="grafana-pyroscope-app:",v.l=(e,r,o,a)=>{if(u[e])u[e].push(r);else{var n,t;if(void 0!==o)for(var i=document.getElementsByTagName("script"),p=0;p<i.length;p++){var l=i[p];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==f+o){n=l;break}}n||(t=!0,(n=document.createElement("script")).charset="utf-8",v.nc&&n.setAttribute("nonce",v.nc),n.setAttribute("data-webpack",f+o),n.src=e,0!==n.src.indexOf(window.location.origin+"/")&&(n.crossOrigin="anonymous"),n.integrity=v.sriHashes[a],n.crossOrigin="anonymous"),u[e]=[r];var s=(r,o)=>{n.onerror=n.onload=null,clearTimeout(c);var a=u[e];if(delete u[e],n.parentNode&&n.parentNode.removeChild(n),a&&a.forEach(e=>e(o)),r)return r(o)},c=setTimeout(s.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=s.bind(null,n.onerror),n.onload=s.bind(null,n.onload),t&&document.head.appendChild(n)}},v.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},v.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),v.p="public/plugins/grafana-pyroscope-app/",v.sriHashes={72:"sha256-8cptBwJUo1yXeiE/luLTQyTQ61oMiXMljKJOJaVcqfE=",156:"sha256-L/GMANVU81LhwuCyZdiEv1eghuTOTAWIb67XZJxz2qM=",580:"sha256-ALshlHtRA5Txx7qo7m/Ks6HpYZhNuioQTvL1oigC2kk=",776:"sha256-K98dl4Kn8fUJA0z4/d55fLEiry+ISh0XrIEjVmlH228=",814:"sha256-703uhwyNWUFg5DGOXRVJVvG8uFJhFKUnjLYVQZPr6q8=",909:"sha256-JKDMWah29M+mbu3OKkl7KUsJ5voz4nJX5kcDebi2iGg="},(()=>{var e={231:0};v.f.j=(r,o)=>{var a=v.o(e,r)?e[r]:void 0;if(0!==a)if(a)o.push(a[2]);else{var n=new Promise((o,n)=>a=e[r]=[o,n]);o.push(a[2]=n);var t=v.p+v.u(r),i=new Error;v.l(t,o=>{if(v.o(e,r)&&(0!==(a=e[r])&&(e[r]=void 0),a)){var n=o&&("load"===o.type?"missing":o.type),t=o&&o.target&&o.target.src;i.message="Loading chunk "+r+" failed.\n("+n+": "+t+")",i.name="ChunkLoadError",i.type=n,i.request=t,a[1](i)}},"chunk-"+r,r)}};var r=(r,o)=>{var a,n,[t,i,p]=o,l=0;if(t.some(r=>0!==e[r])){for(a in i)v.o(i,a)&&(v.m[a]=i[a]);if(p)p(v)}for(r&&r(o);l<t.length;l++)n=t[l],v.o(e,n)&&e[n]&&e[n][0](),e[n]=0},o=self.webpackChunkgrafana_pyroscope_app=self.webpackChunkgrafana_pyroscope_app||[];o.forEach(r.bind(null,0)),o.push=r.bind(null,o.push.bind(o))})();var h={};v.r(h),v.d(h,{plugin:()=>A});var b=v(41308),y=v.n(b);v.p=y()&&y().uri?y().uri.slice(0,y().uri.lastIndexOf("/")+1):"public/plugins/grafana-pyroscope-app/";var S=v(87781),x=v(85959),w=v.n(x);const T=w().lazy(()=>Promise.all([v.e(909),v.e(814),v.e(72),v.e(580)]).then(v.bind(v,45694)).then(e=>({default:e.App})));const H=(0,x.lazy)(()=>Promise.all([v.e(909),v.e(72),v.e(776)]).then(v.bind(v,49776)));function P(e){var r,o,a;const{timeRange:n,pyroscopeQuery:t,explorationType:i}=e;var p;if(!t.profileTypeId&&!(null===(r=t.labelSelector)||void 0===r?void 0:r.includes("service_name")))return function(e,r){const o=new URLSearchParams;return o.append("var-dataSource",e),o.append("explorationType","all"),r&&(o.append("from",r.from.toString()),o.append("to",r.to.toString())),`/a/grafana-pyroscope-app/explore?${o.toString()}`}((null===(p=t.datasource)||void 0===p?void 0:p.uid)||"",n);const l=null===(a=t.labelSelector)||void 0===a||null===(o=a.match(/service_name="([^"]+)"/))||void 0===o?void 0:o[1],s=function(e,r){return r||(e?"labels":"all")}(l,i),c=function(e,r,o,a){const n=[];return function(e,r,o,a){var n;e.push(`var-dataSource=${null===(n=r.datasource)||void 0===n?void 0:n.uid}`),a&&e.push(`var-serviceName=${a}`),e.push(`var-profileMetricId=${r.profileTypeId}`),e.push(`explorationType=${o}`)}(n,e,o,a),function(e,r,o,a){!function(e,r){r&&(e.push(`from=${r.from.toString()}`),e.push(`to=${r.to.toString()}`))}(e,o),function(e,r){var o;(null===(o=r.spanSelector)||void 0===o?void 0:o.length)&&e.push(`var-spanSelector=${r.spanSelector.join(",")}`),r.maxNodes&&e.push(`maxNodes=${r.maxNodes}`)}(e,r),function(e,r,o){if(!function(e){return"labels"===e||"flame-graph"===e}(r)||!o.labelSelector)return;const a=function(e){const r=[],o=/(\w+)(=|!=|=~|!~)"([^"]+)"/g;let a;for(;null!==(a=o.exec(e));)if("service_name"!==a[1]){const e="|";r.push(`${a[1]}${e}${a[2]}${e}${a[3]}`)}return r}(o.labelSelector);a.length&&e.push(`var-filters=${a.join(",")}`)}(e,a,r)}(n,e,r,o),n.join("&")}(t,n,s,l);return`/a/grafana-pyroscope-app/explore?${new URLSearchParams(c).toString()}`}const N={targets:[S.PluginExtensionPoints.ExploreToolbarAction,"grafana-assistant-app/navigateToDrilldown/v1"],title:"Open in Grafana Profiles Drilldown",icon:"fire",description:"Try our new queryless experience for profiles",path:"/a/grafana-pyroscope-app/explore",configure(e){if(!e||!e.targets||!e.timeRange||e.targets.length>1)return;const r=e.targets[0];return r.datasource&&"grafana-pyroscope-datasource"===r.datasource.type?{path:P({pyroscopeQuery:r,timeRange:e.timeRange,explorationType:e.explorationType})}:void 0}},j={targets:["grafana/traceview/details"],title:"Open in Grafana Profiles Drilldown",description:"Try our new queryless experience for profiles",path:"/a/grafana-pyroscope-app/explore",onClick:(e,{context:r})=>{if(!(r&&r.serviceName&&r.spanSelector&&r.profileTypeId&&r.timeRange))return;const o=r.serviceName,a=r.spanSelector,n=r.profileTypeId,t=r.timeRange,i={refId:"span-flamegraph-profiles-drilldown-refId",labelSelector:`service_name="${o}"`,profileTypeId:n,spanSelector:a,datasource:r.datasource,groupBy:["service_name"]};if(i.datasource){const e=P({pyroscopeQuery:i,timeRange:t,explorationType:"flame-graph"});window.open(e,"_blank","noopener,noreferrer")}}},A=(new S.AppPlugin).addLink(N).addLink(j).setRootPage(function(){return w().createElement(x.Suspense,null,w().createElement(T,null))}).exposeComponent({id:"grafana-pyroscope-app/embedded-profiles-exploration/v1",title:"Embedded Profiles Exploration",description:"A component that renders a profiles exploration view that can be embedded in other parts of Grafana.",component:function(e){return w().createElement(x.Suspense,{fallback:w().createElement("div",null,"Loading...")},w().createElement(H,e))}});return h})());
//# sourceMappingURL=module.js.map