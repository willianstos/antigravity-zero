{"version":3,"file":"7.js?_cache=6b87f1fe5ee1ba7b1392","mappings":"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","sources":["webpack://grafana-lokiexplore-app/./services/highlight.tsx","webpack://grafana-lokiexplore-app/./services/JSONHighlightLineFilterMatches.ts","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONLabelText.tsx","webpack://grafana-lokiexplore-app/./services/JSONFilter.ts","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONNestedNodeFilterButton.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONFilterButtons.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONLeafNodeLabelButtons.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONMetadataButtons.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONRootNodeNavigation.tsx","webpack://grafana-lokiexplore-app/./services/JSONVizNodes.ts","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONLeafLabel.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/ReRootJSONButton.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONParentNodeFilterButtons.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/LabelRenderer.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONLinkNodeButton.tsx","webpack://grafana-lokiexplore-app/./services/logsSyntaxMatches.ts","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/ValueRenderer.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONLineItemType.tsx","webpack://grafana-lokiexplore-app/./Components/Buttons/CopyToClipboardButton.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/JSONLogLineActionButtons.tsx","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/ItemString.tsx","webpack://grafana-lokiexplore-app/../node_modules/@gtk-grafana/react-json-tree/dist/main.js","webpack://grafana-lokiexplore-app/./Components/ServiceScene/JSONPanel/LogsJSONComponent.tsx","webpack://grafana-lokiexplore-app/./Components/UI/ImgButton.tsx"],"sourcesContent":["import React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { AdHocFilterWithLabels } from '@grafana/scenes';\n\nimport { LineFilterOp } from './filterTypes';\nimport { logger } from './logger';\n\nexport type TextWithHighlightedValue = Array<React.JSX.Element | string>;\n\nexport const getLineFilterRegExps = (filters: AdHocFilterWithLabels[]): Array<RegExp | undefined> => {\n  return filters\n    .filter(\n      (search) => (search.operator === LineFilterOp.match || search.operator === LineFilterOp.regex) && search.value\n    )\n    .map((search) => {\n      try {\n        return new RegExp(search.value, search.key === 'caseSensitive' ? 'g' : 'gi');\n      } catch (e) {\n        logger.info('Error executing match expression', { regex: search.value });\n        return undefined;\n      }\n    })\n    .filter((f) => f);\n};\n\nconst getWrappingElement = (className: string | undefined, jsxValues: string) => {\n  if (className) {\n    return <span className={className}>{jsxValues}</span>;\n  } else {\n    return <mark>{jsxValues}</mark>;\n  }\n};\n/**\n *\n * @param valueArray - array of chars to be wrapped\n * @param className - if defined, will wrap matches with span containing this classname instead of <mark> element\n */\nexport const mergeStringsAndElements = (valueArray: Array<{ value: string } | string>, className?: string) => {\n  let result: TextWithHighlightedValue = [];\n\n  let jsxValues = '';\n  let stringValues = '';\n  for (let i = 0; i < valueArray.length; i++) {\n    const char = valueArray[i];\n\n    // Merge contiguous jsx elements\n    if (typeof char === 'string') {\n      if (jsxValues) {\n        result.push(getWrappingElement(className, jsxValues));\n        jsxValues = '';\n      }\n      stringValues += char;\n    } else {\n      if (stringValues) {\n        result.push(stringValues);\n        stringValues = '';\n      }\n      jsxValues += char.value;\n    }\n  }\n\n  if (stringValues) {\n    result.push(stringValues);\n  }\n  if (jsxValues) {\n    result.push(getWrappingElement(className, jsxValues));\n  }\n  return result;\n};\nexport const highlightValueStringMatches = (\n  matchingIntervals: Array<[number, number]>,\n  value: string,\n  size: number,\n  className?: string\n) => {\n  let valueArray: Array<{ value: string } | string> = [];\n  let lineFilterMatchIndex = 0;\n  let matchInterval = matchingIntervals[lineFilterMatchIndex];\n\n  for (let valueIndex = 0; valueIndex < value.length; valueIndex++) {\n    // Size is 1 based length, lineFilterMatchIndex is 0 based index\n    while (valueIndex >= matchInterval[1] && lineFilterMatchIndex < size - 1) {\n      lineFilterMatchIndex++;\n      matchInterval = matchingIntervals[lineFilterMatchIndex];\n    }\n    if (valueIndex >= matchInterval[0] && valueIndex < matchInterval[1]) {\n      // this char is part of highlight, return an object in the array so we don't lose the original order, and we can differentiate between highlighted text in the subsequent merge\n      valueArray.push({ value: value[valueIndex] });\n    } else {\n      valueArray.push(value[valueIndex]);\n    }\n  }\n\n  return mergeStringsAndElements(valueArray, className);\n};\n\n// @todo cache results by regex/value?\nexport const getMatchingIntervals = (\n  matchExpressions: Array<RegExp | undefined>,\n  value: string\n): Array<[number, number]> => {\n  let results: Array<[number, number]> = [];\n  matchExpressions.forEach((regex) => {\n    let valueMatch: RegExpExecArray | null | undefined;\n    let valueMatches: RegExpExecArray[] = [];\n    do {\n      try {\n        valueMatch = regex?.exec(value);\n        // Did we match something?\n        if (valueMatch) {\n          // If we have a valid result\n          if (valueMatch[0]) {\n            valueMatches.push(valueMatch);\n          } else {\n            // Otherwise break the loop\n            valueMatch = null;\n          }\n        }\n      } catch (e) {\n        logger.info('Error executing match expression', { regex: regex?.source ?? '' });\n        valueMatch = null;\n      }\n    } while (valueMatch);\n    if (valueMatches.length) {\n      const fromToArray: Array<[number, number]> = valueMatches.map((vm) => [vm.index, vm.index + vm[0].length]);\n      results.push(...fromToArray);\n    }\n  });\n\n  return results;\n};\n\nfunction mergeOverlap(arr: number[][]) {\n  // Merge overlapping intervals in-place. We return\n  // modified size of the array arr.\n\n  // Sort intervals based on start values\n  arr.sort((a, b) => a[0] - b[0]);\n\n  // Index of the last merged\n  let resIdx = 0;\n\n  for (let i = 1; i < arr.length; i++) {\n    // If current interval overlaps with the\n    // last merged interval\n    if (arr[resIdx][1] >= arr[i][0]) {\n      arr[resIdx][1] = Math.max(arr[resIdx][1], arr[i][1]);\n    }\n    // Move to the next interval\n    else {\n      resIdx++;\n      arr[resIdx] = arr[i];\n    }\n  }\n\n  // Returns size of the merged intervals\n  return resIdx + 1;\n}\n\nexport const mergeOverlapping = (matchIndices: number[][]) => {\n  if (matchIndices.length) {\n    return mergeOverlap(matchIndices);\n  }\n  return 0;\n};\n\nexport const getLogsHighlightStyles = (theme: GrafanaTheme2) => {\n  // @todo find way to sync/pull from core?\n  const colors = {\n    critical: '#B877D9',\n    debug: '#6E9FFF',\n    error: theme.colors.error.text,\n    info: '#6CCF8E',\n    metadata: theme.colors.text.primary,\n    parsedField: theme.colors.text.primary,\n    trace: '#6ed0e0',\n    warning: theme.colors.warning.text,\n  };\n\n  return {\n    '.log-token-critical': {\n      color: colors.critical,\n    },\n    '.log-token-debug': {\n      color: colors.debug,\n    },\n    '.log-token-duration': {\n      color: theme.colors.success.text,\n    },\n    '.log-token-error': {\n      color: colors.error,\n    },\n    '.log-token-info': {\n      color: colors.info,\n    },\n    '.log-token-json-key': {\n      color: colors.parsedField,\n      fontWeight: theme.typography.fontWeightMedium,\n      opacity: 0.9,\n    },\n    '.log-token-key': {\n      color: colors.parsedField,\n      fontWeight: theme.typography.fontWeightMedium,\n      opacity: 0.9,\n    },\n    '.log-token-label': {\n      color: colors.metadata,\n      fontWeight: theme.typography.fontWeightBold,\n    },\n    '.log-token-method': {\n      color: theme.colors.info.shade,\n    },\n    '.log-token-size': {\n      color: theme.colors.success.text,\n    },\n    '.log-token-trace': {\n      color: colors.trace,\n    },\n    '.log-token-uuid': {\n      color: theme.colors.success.text,\n    },\n    '.log-token-warning': {\n      color: colors.warning,\n    },\n  };\n};\n","import { AdHocFilterWithLabels } from '@grafana/scenes';\n\nimport {\n  getLineFilterRegExps,\n  getMatchingIntervals,\n  highlightValueStringMatches,\n  mergeOverlapping,\n  TextWithHighlightedValue,\n} from 'services/highlight';\n\nexport function JSONHighlightLineFilterMatches(\n  lineFilters: AdHocFilterWithLabels[],\n  value: string,\n  className?: string\n) {\n  const matchExpressions = getLineFilterRegExps(lineFilters);\n  const lineFilterMatches = getMatchingIntervals(matchExpressions, value);\n  const size = mergeOverlapping(lineFilterMatches);\n  let valueArray: TextWithHighlightedValue = [];\n\n  if (lineFilterMatches.length) {\n    valueArray = highlightValueStringMatches(lineFilterMatches, value, size, className);\n  }\n  return valueArray;\n}\n\nexport function JSONHighlightRegexMatches(regex: RegExp[], value: string, className: string) {\n  const lineFilterMatches = getMatchingIntervals(regex, value);\n  const size = mergeOverlapping(lineFilterMatches);\n  let valueArray: TextWithHighlightedValue = [];\n\n  if (lineFilterMatches.length) {\n    valueArray = highlightValueStringMatches(lineFilterMatches, value, size, className);\n  }\n  return valueArray;\n}\n","import React from 'react';\n\nimport { useStyles2 } from '@grafana/ui';\n\nimport { getJSONLabelWrapStyles } from 'services/JSONViz';\n\ninterface Props {\n  keyPathString: string | number;\n  text: Array<string | React.JSX.Element>;\n}\n\nexport function JSONLabelText({ text, keyPathString }: Props) {\n  const styles = useStyles2(getJSONLabelWrapStyles);\n  return <strong className={styles.JSONLabelWrapStyles}>{text.length ? text : keyPathString}:</strong>;\n}\n","import { sceneGraph, SceneObject } from '@grafana/scenes';\n\nimport {\n  addToFilters,\n  FilterType,\n  InterpolatedFilterType,\n} from '../Components/ServiceScene/Breakdowns/AddToFiltersButton';\nimport { JSONLogsScene } from '../Components/ServiceScene/JSONLogsScene';\nimport { LogsListScene } from '../Components/ServiceScene/LogsListScene';\nimport { reportAppInteraction, USER_EVENTS_ACTIONS, USER_EVENTS_PAGES } from './analytics';\nimport { addJsonParserFieldValue } from './filters';\nimport { LABEL_NAME_INVALID_CHARS } from './labels';\nimport { addCurrentUrlToHistory } from './navigate';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\n\ninterface JsonFilterProps {\n  filterType: FilterType;\n  key: string;\n  keyPath: KeyPath;\n  logsJsonScene: JSONLogsScene;\n  value: string;\n  variableType: InterpolatedFilterType;\n}\n\nexport const addJSONFieldFilter = ({\n  key,\n  keyPath,\n  value,\n  filterType,\n  logsJsonScene,\n  variableType,\n}: JsonFilterProps) => {\n  addCurrentUrlToHistory();\n  // https://grafana.com/docs/loki/latest/get-started/labels/#label-format\n  key = key.replace(LABEL_NAME_INVALID_CHARS, '_');\n\n  addJsonParserFieldValue(logsJsonScene, keyPath);\n\n  const logsListScene = sceneGraph.getAncestor(logsJsonScene, LogsListScene);\n  addToFilters(key, value, filterType, logsListScene, variableType, false, true);\n\n  reportAppInteraction(\n    USER_EVENTS_PAGES.service_details,\n    USER_EVENTS_ACTIONS.service_details.add_to_filters_in_json_panel,\n    {\n      action: filterType,\n      filterType: 'json',\n      key,\n    }\n  );\n};\n\ninterface NestedNodeFilterProps {\n  filterType: FilterType;\n  label: string;\n  sceneRef: SceneObject;\n  value: string;\n  variableType: InterpolatedFilterType;\n}\n\nexport const addJSONMetadataFilter = ({ label, value, filterType, variableType, sceneRef }: NestedNodeFilterProps) => {\n  addCurrentUrlToHistory();\n  addToFilters(label, value, filterType, sceneRef, variableType, false);\n  reportAppInteraction(\n    USER_EVENTS_PAGES.service_details,\n    USER_EVENTS_ACTIONS.service_details.add_to_filters_in_json_panel,\n    {\n      action: filterType,\n      filterType,\n      label: label,\n    }\n  );\n};\n","import React, { lazy, useMemo } from 'react';\n\nimport { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { JSONLogsScene } from '../JSONLogsScene';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\nimport { addJSONFieldFilter } from 'services/JSONFilter';\nimport { EMPTY_VARIABLE_VALUE, VAR_FIELDS } from 'services/variables';\nconst ImgButton = lazy(() => import('../../UI/ImgButton'));\n\ninterface Props {\n  active: boolean;\n  fullKeyPath: string;\n  keyPath: KeyPath;\n  logsJsonScene: JSONLogsScene;\n  type: 'exclude' | 'include';\n}\n\nexport function JSONNestedNodeFilterButton({ active, fullKeyPath, keyPath, type, logsJsonScene }: Props) {\n  const styles = useStyles2(getJSONFilterButtonStyles, active);\n  return useMemo(\n    () => (\n      <ImgButton\n        className={styles.button}\n        tooltip={`${type === 'include' ? 'Include' : 'Exclude'} log lines that contain ${keyPath[0]}`}\n        onClick={(e) => {\n          e.stopPropagation();\n          addJSONFieldFilter({\n            value: EMPTY_VARIABLE_VALUE,\n            key: fullKeyPath,\n            variableType: VAR_FIELDS,\n            logsJsonScene,\n            keyPath,\n            filterType: active ? 'toggle' : type === 'include' ? 'exclude' : 'include',\n          });\n        }}\n        aria-selected={active}\n        variant={active ? 'primary' : 'secondary'}\n        name={type === 'include' ? 'search-plus' : 'search-minus'}\n        aria-label={`${type} filter`}\n      />\n    ),\n    [active, keyPath, fullKeyPath, logsJsonScene, styles.button, type]\n  );\n}\n\nexport const getJSONFilterButtonStyles = (theme: GrafanaTheme2, isActive: boolean) => {\n  return {\n    button: css({\n      color: isActive ? undefined : theme.colors.text.secondary,\n      '&:hover': {\n        color: theme.colors.text.maxContrast,\n      },\n    }),\n  };\n};\n","import React, { lazy, memo, useMemo } from 'react';\n\nimport { AdHocFilterWithLabels, SceneObject } from '@grafana/scenes';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { InterpolatedFilterType } from '../Breakdowns/AddToFiltersButton';\nimport { JSONLogsScene } from '../JSONLogsScene';\nimport { getJSONFilterButtonStyles } from './JSONNestedNodeFilterButton';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\nimport { FilterOp } from 'services/filterTypes';\nimport { addJSONFieldFilter, addJSONMetadataFilter } from 'services/JSONFilter';\nimport { VAR_FIELDS } from 'services/variables';\n\nconst ImgButton = lazy(() => import('../../UI/ImgButton'));\n\ninterface JsonFilterProps {\n  existingFilter?: AdHocFilterWithLabels;\n  fullKey: string;\n  keyPath: KeyPath;\n  label: string | number;\n  model: JSONLogsScene;\n  type: 'exclude' | 'include';\n  value: string;\n}\n\nexport const JSONFieldValueButton = memo(\n  ({ existingFilter, fullKey, keyPath, label, type, value, model }: JsonFilterProps) => {\n    const operator = type === 'include' ? FilterOp.Equal : FilterOp.NotEqual;\n    const isActive = existingFilter?.operator === operator;\n    const styles = useStyles2(getJSONFilterButtonStyles, isActive);\n    const selected = existingFilter?.operator === operator;\n\n    return useMemo(\n      () => (\n        <ImgButton\n          className={styles.button}\n          tooltip={`${type === 'include' ? 'Include' : 'Exclude'} log lines containing ${label}=\"${value}\"`}\n          onClick={(e) => {\n            e.stopPropagation();\n            addJSONFieldFilter({\n              keyPath: keyPath,\n              key: fullKey,\n              value,\n              filterType: selected ? 'toggle' : type,\n              logsJsonScene: model,\n              variableType: VAR_FIELDS,\n            });\n          }}\n          aria-selected={isActive}\n          variant={isActive ? 'primary' : 'secondary'}\n          name={type === 'include' ? 'search-plus' : 'search-minus'}\n          aria-label={`${type} filter`}\n        />\n      ),\n      [isActive, selected, type, styles.button, keyPath, fullKey, value, label, model]\n    );\n  }\n);\nJSONFieldValueButton.displayName = 'JSONFilterValueButton';\n\ninterface MetadataFilterProps {\n  existingFilter?: AdHocFilterWithLabels;\n  label: string;\n  sceneRef: SceneObject;\n  type: 'exclude' | 'include';\n  value: string;\n  variableType: InterpolatedFilterType;\n}\n\nexport const JSONMetadataButton = memo(\n  ({ existingFilter, label, type, value, variableType, sceneRef }: MetadataFilterProps) => {\n    const operator = type === 'include' ? FilterOp.Equal : FilterOp.NotEqual;\n    const isActive = existingFilter?.operator === operator;\n    const styles = useStyles2(getJSONFilterButtonStyles, isActive);\n    const selected = existingFilter?.operator === operator;\n\n    return useMemo(\n      () => (\n        <ImgButton\n          className={styles.button}\n          tooltip={`${type === 'include' ? 'Include' : 'Exclude'} log lines containing ${label}=\"${value}\"`}\n          onClick={(e) => {\n            e.stopPropagation();\n\n            addJSONMetadataFilter({\n              label,\n              value,\n              filterType: selected ? 'toggle' : type,\n              variableType,\n              sceneRef,\n            });\n          }}\n          aria-selected={selected}\n          variant={selected ? 'primary' : 'secondary'}\n          name={type === 'include' ? 'search-plus' : 'search-minus'}\n          aria-label={`${type} filter`}\n        />\n      ),\n      [selected, label, sceneRef, styles.button, type, value, variableType]\n    );\n  }\n);\nJSONMetadataButton.displayName = 'JSONMetadataButton';\n","import React, { ReactNode } from 'react';\n\nimport { AdHocFilterWithLabels } from '@grafana/scenes';\n\nimport { JSONLogsScene } from '../JSONLogsScene';\nimport { JSONFieldValueButton } from './JSONFilterButtons';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\n\ninterface Props {\n  elements: ReactNode[];\n  existingFilter?: AdHocFilterWithLabels;\n  fullKey: string;\n  fullKeyPath: KeyPath;\n  JSONFiltersSupported: boolean | undefined;\n  keyPathString: string | number;\n  label: string | number;\n  model: JSONLogsScene;\n  value: string;\n}\n\nexport function JSONLeafNodeLabelButtons({ label, value, fullKeyPath, fullKey, existingFilter, model }: Props) {\n  return (\n    <>\n      <JSONFieldValueButton\n        label={label}\n        value={value}\n        keyPath={fullKeyPath}\n        fullKey={fullKey}\n        existingFilter={existingFilter}\n        type={'include'}\n        model={model}\n      />\n      <JSONFieldValueButton\n        label={label}\n        value={value}\n        keyPath={fullKeyPath}\n        fullKey={fullKey}\n        existingFilter={existingFilter}\n        type={'exclude'}\n        model={model}\n      />\n    </>\n  );\n}\n","import React from 'react';\n\nimport { AdHocFilterWithLabels, SceneObject } from '@grafana/scenes';\n\nimport { InterpolatedFilterType } from '../Breakdowns/AddToFiltersButton';\nimport { JSONMetadataButton } from './JSONFilterButtons';\nimport { isOperatorExclusive, isOperatorInclusive } from 'services/operatorHelpers';\n\ninterface Props {\n  existingFilter: AdHocFilterWithLabels[];\n  label: string | number;\n  sceneRef: SceneObject;\n  value: string;\n  variableType: InterpolatedFilterType;\n}\n\n/**\n * Labels and metadata nodes\n */\nexport function JSONMetadataButtons({ existingFilter, label, sceneRef, value, variableType }: Props) {\n  const isFilterInclusive = (filter: AdHocFilterWithLabels) => isOperatorInclusive(filter.operator);\n  const isFilterExclusive = (filter: AdHocFilterWithLabels) => isOperatorExclusive(filter.operator);\n  return (\n    <>\n      {/* Include */}\n      <JSONMetadataButton\n        type={'include'}\n        label={label.toString()}\n        value={value}\n        variableType={variableType}\n        existingFilter={existingFilter.find(isFilterInclusive)}\n        sceneRef={sceneRef}\n      />\n      {/* Exclude */}\n      <JSONMetadataButton\n        type={'exclude'}\n        label={label.toString()}\n        value={value}\n        variableType={variableType}\n        existingFilter={existingFilter.find(isFilterExclusive)}\n        sceneRef={sceneRef}\n      />\n    </>\n  );\n}\n","import React from 'react';\n\nimport { AdHocFilterWithLabels, SceneObject } from '@grafana/scenes';\nimport { Button, Icon } from '@grafana/ui';\n\nimport { JSONDataFrameLineName, JSONVizRootName } from '../JSONLogsScene';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\nimport { reportAppInteraction, USER_EVENTS_ACTIONS, USER_EVENTS_PAGES } from 'services/analytics';\nimport { clearJSONParserFields, isLogLineField } from 'services/fields';\nimport { addJsonParserFieldValue, EMPTY_AD_HOC_FILTER_VALUE, removeLineFormatFilters } from 'services/filters';\nimport { LineFormatFilterOp } from 'services/filterTypes';\nimport { breadCrumbDelimiter, drillUpWrapperStyle, itemStringDelimiter } from 'services/JSONViz';\nimport { LABEL_NAME_INVALID_CHARS } from 'services/labels';\nimport { addCurrentUrlToHistory } from 'services/navigate';\nimport { getFieldsVariable, getJSONFieldsVariable, getLineFormatVariable } from 'services/variableGetters';\n\ninterface Props {\n  sceneRef: SceneObject;\n}\n\n/**\n * Gets re-root button and key label for root node when line format filter is active.\n * aka breadcrumbs\n */\nexport default function JSONRootNodeNavigation({ sceneRef }: Props) {\n  const lineFormatVar = getLineFormatVariable(sceneRef);\n  const filters = lineFormatVar.state.filters;\n  const rootKeyPath = [JSONDataFrameLineName, 0, JSONVizRootName];\n\n  return (\n    <>\n      <span className={drillUpWrapperStyle} key={JSONVizRootName}>\n        <Button\n          size={'sm'}\n          onClick={() => setNewRootNode(rootKeyPath, sceneRef)}\n          variant={'secondary'}\n          fill={'outline'}\n          disabled={!filters.length}\n          name={JSONVizRootName}\n        >\n          {JSONVizRootName}\n        </Button>\n        {filters.length > 0 && <Icon className={breadCrumbDelimiter} name={'angle-right'} />}\n      </span>\n\n      {filters.map((filter, i) => {\n        const selected = filter.key === filters[filters.length - 1].key;\n        return (\n          <span className={drillUpWrapperStyle} key={filter.key}>\n            {\n              <Button\n                size={'sm'}\n                disabled={selected}\n                onClick={() => addDrillUp(filter.key, sceneRef)}\n                variant={'secondary'}\n                fill={'outline'}\n              >\n                {filter.key}\n              </Button>\n            }\n            {i < filters.length - 1 && <Icon className={breadCrumbDelimiter} name={'angle-right'} />}\n            {i === filters.length - 1 && <Icon className={itemStringDelimiter} name={'angle-right'} />}\n          </span>\n        );\n      })}\n    </>\n  );\n}\n\nexport function getFullKeyPath(\n  keyPath: ReadonlyArray<string | number>,\n  sceneObject: SceneObject\n): { fullKeyPath: KeyPath; fullPathFilters: AdHocFilterWithLabels[] } {\n  const lineFormatVar = getLineFormatVariable(sceneObject);\n\n  const fullPathFilters: AdHocFilterWithLabels[] = [\n    ...lineFormatVar.state.filters,\n    ...keyPath\n      // line format filters only store the parent node field names\n      .filter((key) => typeof key === 'string' && !isLogLineField(key) && key !== JSONVizRootName)\n      // keyPath order is from child to root, we want to order from root to child\n      .reverse()\n      // convert to ad-hoc filter\n      .map((nodeKey) => ({\n        key: nodeKey.toString(),\n        // The operator and value are not used when interpolating the variable, but empty values will cause the ad-hoc filter to get removed from the URL state, we work around this by adding an empty space for the value and operator\n        // we could store the depth of the node as a value, right now we assume that these filters always include every parent node of the current node, ordered by node depth ASC (root node first)\n        operator: LineFormatFilterOp.Empty,\n        value: EMPTY_AD_HOC_FILTER_VALUE,\n      })),\n  ];\n  // the last 3 in the key path are always array\n  const fullKeyPath = [...fullPathFilters.map((filter) => filter.key).reverse(), ...keyPath.slice(-3)];\n  return { fullKeyPath, fullPathFilters };\n}\n\nexport const setNewRootNode = (keyPath: KeyPath, sceneRef: SceneObject) => {\n  addCurrentUrlToHistory();\n  const { fullKeyPath, fullPathFilters } = getFullKeyPath(keyPath, sceneRef);\n  // If keyPath length is greater than 3 we're drilling down (root, line index, line)\n  if (keyPath.length > 3) {\n    addJsonParserFieldValue(sceneRef, fullKeyPath);\n\n    const lineFormatVar = getLineFormatVariable(sceneRef);\n\n    lineFormatVar.setState({\n      // Need to strip out any unsupported chars to match the field name we're creating in the json parser args\n      filters: fullPathFilters.map((filter) => ({\n        ...filter,\n        key: filter.key.replace(LABEL_NAME_INVALID_CHARS, '_'),\n      })),\n    });\n    lineFormatEvent('add', keyPath[0].toString());\n  } else {\n    // Otherwise we're drilling back up to the root\n    removeLineFormatFilters(sceneRef);\n    clearJSONParserFields(sceneRef);\n    lineFormatEvent('remove', JSONVizRootName);\n  }\n};\n\n/**\n * Fires rudderstack event when the viz adds/removes a new root (line format)\n */\nexport const lineFormatEvent = (type: 'add' | 'remove', key: string) => {\n  reportAppInteraction(\n    USER_EVENTS_PAGES.service_details,\n    USER_EVENTS_ACTIONS.service_details.change_line_format_in_json_panel,\n    {\n      key,\n      type: type,\n    }\n  );\n};\n\n/**\n * Drill back up to a parent node via the sticky \"breadcrumbs\"\n * @param key\n * @param sceneRef\n */\nexport const addDrillUp = (key: string, sceneRef: SceneObject) => {\n  addCurrentUrlToHistory();\n\n  const lineFormatVariable = getLineFormatVariable(sceneRef);\n  const JSONVar = getJSONFieldsVariable(sceneRef);\n  const fieldsVar = getFieldsVariable(sceneRef);\n\n  const lineFormatFilters = lineFormatVariable.state.filters;\n  const keyIndex = lineFormatFilters.findIndex((filter) => filter.key === key);\n  const lineFormatFiltersToKeep = lineFormatFilters.filter((_, index) => index <= keyIndex);\n  const JSONParserKeys: string[] = [];\n\n  for (let i = 0; i < lineFormatFilters.length; i++) {\n    JSONParserKeys.push(\n      `${\n        JSONParserKeys.length\n          ? `${lineFormatFilters\n              .map((filter) => filter.key)\n              .slice(0, i)\n              .join('_')}_`\n          : ''\n      }${lineFormatFilters[i].key}`\n    );\n  }\n\n  const JSONParserKeysToRemove = JSONParserKeys.slice(keyIndex + 1);\n  const fieldsFilterSet = new Set();\n  fieldsVar.state.filters.forEach((fieldFilter) => fieldsFilterSet.add(fieldFilter.key));\n\n  const JSONParserFilters = JSONVar.state.filters.filter(\n    (filter) => !JSONParserKeysToRemove.includes(filter.key) || fieldsFilterSet.has(filter.key)\n  );\n\n  JSONVar.setState({\n    filters: JSONParserFilters,\n  });\n  lineFormatVariable.setState({\n    filters: lineFormatFiltersToKeep,\n  });\n\n  lineFormatEvent('remove', key);\n};\n","import {\n  JSONDataFrameLabelsName,\n  JSONDataFrameStructuredMetadataName,\n  JSONDataFrameTimeName,\n} from '../Components/ServiceScene/JSONLogsScene';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\n\n/**\n * Determines if the current node is the timestamp label\n * @param keyPath\n */\nexport const isTimeLabelNode = (keyPath: KeyPath) => {\n  return keyPath[0] === JSONDataFrameTimeName;\n};\n\n/**\n * Does the node at keyPath have a metadata or labels parent node?\n * @param keyPath\n */\nexport const hasFieldParentNode = (keyPath: KeyPath) => {\n  return keyPath[1] === JSONDataFrameStructuredMetadataName || keyPath[1] === JSONDataFrameLabelsName;\n};\n","import React from 'react';\n\nimport { Field } from '@grafana/data';\nimport { AdHocFiltersVariable, AdHocFilterWithLabels } from '@grafana/scenes';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { JSONHighlightLineFilterMatches } from '../../../services/JSONHighlightLineFilterMatches';\nimport { InterpolatedFilterType } from '../Breakdowns/AddToFiltersButton';\nimport {\n  getKeyPathString,\n  JSONDataFrameLabelsName,\n  JSONDataFrameStructuredMetadataName,\n  JSONLogsScene,\n  JSONVizRootName,\n} from '../JSONLogsScene';\nimport { JSONLabelText } from './JSONLabelText';\nimport { JSONLeafNodeLabelButtons } from './JSONLeafNodeLabelButtons';\nimport { JSONMetadataButtons } from './JSONMetadataButtons';\nimport { getFullKeyPath } from './JSONRootNodeNavigation';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\nimport { getJSONKey } from 'services/filters';\nimport { getJSONLabelWrapStyles, getJSONVizNestedProperty } from 'services/JSONViz';\nimport { hasFieldParentNode } from 'services/JSONVizNodes';\nimport { getAdHocFiltersVariable, getValueFromFieldsFilter } from 'services/variableGetters';\nimport { LEVEL_VARIABLE_VALUE, VAR_FIELDS, VAR_LABELS, VAR_LEVELS, VAR_METADATA } from 'services/variables';\n\ninterface Props {\n  fieldsVar: AdHocFiltersVariable;\n  JSONFiltersSupported: boolean | null;\n  JSONLogsScene: JSONLogsScene;\n  JSONParserPropsMap: Map<string, AdHocFilterWithLabels>;\n  keyPath: KeyPath;\n  lineField: Field<string | number>;\n  lineFilters: AdHocFilterWithLabels[];\n}\n\nexport function JSONLeafLabel({\n  keyPath,\n  lineField,\n  fieldsVar,\n  JSONParserPropsMap,\n  lineFilters,\n  JSONFiltersSupported,\n  JSONLogsScene,\n}: Props) {\n  const value = getValue(keyPath, lineField.values)?.toString();\n  const label = keyPath[0];\n  const existingVariableType = getFilterVariableTypeFromPath(keyPath);\n  const styles = useStyles2(getJSONLabelWrapStyles);\n\n  let highlightedValue: string | Array<string | React.JSX.Element> = [];\n  if (JSONLogsScene.state.hasHighlight && !hasFieldParentNode(keyPath)) {\n    highlightedValue = JSONHighlightLineFilterMatches(lineFilters, keyPath[0].toString());\n  }\n\n  // Field (labels, metadata) nodes\n  if (hasFieldParentNode(keyPath)) {\n    const existingVariable = getAdHocFiltersVariable(existingVariableType, JSONLogsScene);\n    const existingFilter = existingVariable.state.filters.filter(\n      (filter) => filter.key === label.toString() && filter.value === value\n    );\n\n    return (\n      <span className={styles.labelButtonsWrap}>\n        <JSONMetadataButtons\n          sceneRef={JSONLogsScene}\n          label={label}\n          value={value}\n          variableType={existingVariableType}\n          existingFilter={existingFilter}\n        />\n        <JSONLabelText text={highlightedValue} keyPathString={getKeyPathString(keyPath, '')} />\n      </span>\n    );\n  }\n\n  const { fullKeyPath } = getFullKeyPath(keyPath, JSONLogsScene);\n  const fullKey = getJSONKey(fullKeyPath);\n  const JSONParserProp = JSONParserPropsMap.get(fullKey);\n  const existingJSONFilter =\n    JSONParserProp &&\n    fieldsVar.state.filters.find((f) => f.key === JSONParserProp?.key && getValueFromFieldsFilter(f).value === value);\n\n  // Value nodes\n  return (\n    <span className={styles.labelButtonsWrap}>\n      {JSONFiltersSupported && (\n        <JSONLeafNodeLabelButtons\n          JSONFiltersSupported={JSONFiltersSupported}\n          label={label}\n          value={value}\n          fullKeyPath={fullKeyPath}\n          fullKey={fullKey}\n          existingFilter={existingJSONFilter}\n          elements={highlightedValue}\n          keyPathString={getKeyPathString(keyPath, '')}\n          model={JSONLogsScene}\n        />\n      )}\n      <JSONLabelText text={highlightedValue} keyPathString={getKeyPathString(keyPath, '')} />\n    </span>\n  );\n}\n\n/**\n * Gets value from log Field at keyPath\n */\nfunction getValue(keyPath: KeyPath, lineField: Array<string | number>): string | number {\n  const keys = [...keyPath];\n  const accessors = [];\n\n  while (keys.length) {\n    const key = keys.pop();\n\n    if (key !== JSONVizRootName && key !== undefined) {\n      accessors.push(key);\n    }\n  }\n\n  return getJSONVizNestedProperty(lineField, accessors);\n}\n\nfunction getFilterVariableTypeFromPath(keyPath: ReadonlyArray<string | number>): InterpolatedFilterType {\n  if (keyPath[1] === JSONDataFrameStructuredMetadataName) {\n    if (keyPath[0] === LEVEL_VARIABLE_VALUE) {\n      return VAR_LEVELS;\n    }\n    return VAR_METADATA;\n  } else if (keyPath[1] === JSONDataFrameLabelsName) {\n    return VAR_LABELS;\n  } else {\n    return VAR_FIELDS;\n  }\n}\n","import React, { lazy, memo, useMemo } from 'react';\n\nimport { SceneObject } from '@grafana/scenes';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { getJSONFilterButtonStyles } from './JSONNestedNodeFilterButton';\nimport { setNewRootNode } from './JSONRootNodeNavigation';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\n\nconst ImgButton = lazy(() => import('../../UI/ImgButton'));\n\nconst ReRootJSONButton = memo(({ keyPath, sceneRef }: { keyPath: KeyPath; sceneRef: SceneObject }) => {\n  const styles = useStyles2(getJSONFilterButtonStyles, false);\n  return useMemo(\n    () => (\n      <ImgButton\n        className={styles.button}\n        tooltip={`Set ${keyPath[0]} as root node`}\n        onClick={(e) => {\n          e.stopPropagation();\n          setNewRootNode(keyPath, sceneRef);\n        }}\n        name={'eye'}\n        aria-label={`drilldown into ${keyPath[0]}`}\n      />\n    ),\n    [keyPath, sceneRef, styles.button]\n  );\n});\n\nReRootJSONButton.displayName = 'DrilldownButton';\nexport default ReRootJSONButton;\n","import React, { memo } from 'react';\n\nimport { AdHocFilterWithLabels } from '@grafana/scenes';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { JSONHighlightLineFilterMatches } from '../../../services/JSONHighlightLineFilterMatches';\nimport { getJSONLabelWrapStyles } from '../../../services/JSONViz';\nimport { getKeyPathString, JSONLogsScene } from '../JSONLogsScene';\nimport { JSONNestedNodeFilterButton } from './JSONNestedNodeFilterButton';\nimport { getFullKeyPath } from './JSONRootNodeNavigation';\nimport ReRootJSONButton from './ReRootJSONButton';\nimport { KeyPath } from '@gtk-grafana/react-json-tree';\nimport { getJSONKey } from 'services/filters';\nimport { isOperatorExclusive, isOperatorInclusive } from 'services/operatorHelpers';\nimport { getValueFromFieldsFilter } from 'services/variableGetters';\nimport { EMPTY_VARIABLE_VALUE } from 'services/variables';\n\ninterface Props {\n  fieldsFilters: AdHocFilterWithLabels[];\n  JSONFiltersSupported: boolean | null;\n  JSONLogsScene: JSONLogsScene;\n  JSONParserPropsMap: Map<string, AdHocFilterWithLabels>;\n  keyPath: KeyPath;\n  lineFilters: AdHocFilterWithLabels[];\n}\n\nfunction NestedNodeFilterButtonsComponent({\n  keyPath,\n  fieldsFilters,\n  JSONParserPropsMap,\n  lineFilters,\n  JSONFiltersSupported,\n  JSONLogsScene,\n}: Props) {\n  const { fullKeyPath } = getFullKeyPath(keyPath, JSONLogsScene);\n  const fullKey = getJSONKey(fullKeyPath);\n  const styles = useStyles2(getJSONLabelWrapStyles);\n\n  const JSONParserProp = JSONParserPropsMap.get(fullKey);\n  const existingFilter =\n    JSONParserProp &&\n    fieldsFilters.find(\n      (f) => f.key === JSONParserProp?.key && getValueFromFieldsFilter(f).value === EMPTY_VARIABLE_VALUE\n    );\n\n  let highlightedValue: string | Array<string | React.JSX.Element> = [];\n  if (JSONLogsScene.state.hasHighlight) {\n    highlightedValue = JSONHighlightLineFilterMatches(lineFilters, keyPath[0].toString());\n  }\n\n  return (\n    <span className={styles.JSONNestedLabelWrapStyles}>\n      {JSONFiltersSupported && (\n        <>\n          <ReRootJSONButton keyPath={keyPath} sceneRef={JSONLogsScene} />\n          <JSONNestedNodeFilterButton\n            type={'include'}\n            fullKeyPath={fullKey}\n            keyPath={fullKeyPath}\n            active={existingFilter ? isOperatorExclusive(existingFilter.operator) : false}\n            logsJsonScene={JSONLogsScene}\n          />\n          <JSONNestedNodeFilterButton\n            type={'exclude'}\n            fullKeyPath={fullKey}\n            keyPath={fullKeyPath}\n            active={existingFilter ? isOperatorInclusive(existingFilter.operator) : false}\n            logsJsonScene={JSONLogsScene}\n          />\n        </>\n      )}\n      <strong className={styles.JSONLabelWrapStyles}>\n        {highlightedValue.length ? highlightedValue : getKeyPathString(keyPath, '')}:\n      </strong>\n    </span>\n  );\n}\n\nexport const JSONParentNodeFilterButtons = memo(NestedNodeFilterButtonsComponent);\n","import React from 'react';\n\nimport { isNumber } from 'lodash';\n\nimport { Field } from '@grafana/data';\nimport { AdHocFiltersVariable, AdHocFilterWithLabels } from '@grafana/scenes';\nimport { useStyles2 } from '@grafana/ui';\n\nimport {\n  JSONDataFrameLabelsName,\n  JSONDataFrameLinksName,\n  JSONDataFrameStructuredMetadataName,\n  JSONDataFrameTimeName,\n  JSONLinksDisplayName,\n  JSONVizRootName,\n  JSONLabelsDisplayName,\n  JSONLogsScene,\n  NodeType,\n  JSONStructuredMetadataDisplayName,\n} from '../JSONLogsScene';\nimport { JSONLeafLabel } from './JSONLeafLabel';\nimport { JSONParentNodeFilterButtons } from './JSONParentNodeFilterButtons';\nimport JSONRootNodeNavigation from './JSONRootNodeNavigation';\nimport { KeyPath } from '@gtk-grafana/react-json-tree/dist/types';\nimport { isLogLineField } from 'services/fields';\nimport { getJSONLabelWrapStyles, JSONLabelWrapStylesPrimary } from 'services/JSONViz';\nimport { isTimeLabelNode } from 'services/JSONVizNodes';\n\ninterface LabelRendererProps {\n  fieldsVar: AdHocFiltersVariable;\n  JSONFiltersSupported: boolean | null;\n  JSONParserPropsMap: Map<string, AdHocFilterWithLabels>;\n  keyPath: KeyPath;\n  lineField: Field;\n  lineFilters: AdHocFilterWithLabels[];\n  model: JSONLogsScene;\n  nodeType: string;\n}\n\nexport default function LabelRenderer({\n  fieldsVar,\n  JSONFiltersSupported,\n  JSONParserPropsMap,\n  keyPath,\n  lineField,\n  lineFilters,\n  model,\n  nodeType,\n}: LabelRendererProps) {\n  const style = useStyles2(getJSONLabelWrapStyles);\n  const value: string | Array<string | React.JSX.Element> = keyPath[0].toString();\n  const nodeTypeLoc = nodeType as NodeType;\n\n  // Specific implementations for leaf nodes\n  // Metadata node\n  if (keyPath[0] === JSONDataFrameStructuredMetadataName) {\n    return <strong className={style.JSONLabelWrapStyles}>{JSONStructuredMetadataDisplayName}</strong>;\n  }\n  // Labels node\n  if (keyPath[0] === JSONDataFrameLabelsName) {\n    return <strong className={style.JSONLabelWrapStyles}>{JSONLabelsDisplayName}</strong>;\n  }\n  // Links parent\n  if (keyPath[0] === JSONDataFrameLinksName) {\n    return <strong className={style.JSONLabelWrapStyles}>{JSONLinksDisplayName}</strong>;\n  }\n  // Links node\n  if (keyPath[1] === JSONDataFrameLinksName) {\n    return <strong className={style.JSONLabelWrapStyles}>{value}:</strong>;\n  }\n  // Root node\n  if (keyPath[0] === JSONVizRootName) {\n    return <JSONRootNodeNavigation sceneRef={model} />;\n  }\n\n  // Value nodes\n  if (isJSONLeafNode(nodeTypeLoc, keyPath)) {\n    return (\n      <JSONLeafLabel\n        JSONLogsScene={model}\n        keyPath={keyPath}\n        lineField={lineField}\n        fieldsVar={fieldsVar}\n        JSONParserPropsMap={JSONParserPropsMap}\n        lineFilters={lineFilters}\n        JSONFiltersSupported={JSONFiltersSupported}\n      />\n    );\n  }\n\n  // Parent nodes\n  if (isJSONParentNode(nodeTypeLoc, keyPath)) {\n    return (\n      <JSONParentNodeFilterButtons\n        keyPath={keyPath}\n        lineFilters={lineFilters}\n        JSONLogsScene={model}\n        fieldsFilters={fieldsVar.state.filters}\n        JSONParserPropsMap={JSONParserPropsMap}\n        JSONFiltersSupported={JSONFiltersSupported}\n      />\n    );\n  }\n\n  // Show the timestamp as the label of the log line\n  if (isTimestampNode(keyPath) && isNumber(keyPath[0])) {\n    const time: string = lineField.values[keyPath[0]]?.[JSONDataFrameTimeName];\n    return <strong className={JSONLabelWrapStylesPrimary}>{time}</strong>;\n  }\n\n  // Don't render time node\n  if (isTimeLabelNode(keyPath)) {\n    return null;\n  }\n\n  return <strong className={style.JSONLabelWrapStyles}>{value}:</strong>;\n}\n\n/**\n * Is JSON node a leaf node\n * @param nodeTypeLoc\n * @param keyPath\n */\nconst isJSONLeafNode = (nodeTypeLoc: NodeType, keyPath: KeyPath) => {\n  return (\n    nodeTypeLoc !== 'Object' &&\n    nodeTypeLoc !== 'Array' &&\n    keyPath[0] !== JSONDataFrameTimeName &&\n    !isLogLineField(keyPath[0].toString()) &&\n    keyPath[0] !== JSONVizRootName &&\n    !isNumber(keyPath[0])\n  );\n};\n\n/**\n * Is JSON node a parent node\n * @param nodeTypeLoc\n * @param keyPath\n */\nconst isJSONParentNode = (nodeTypeLoc: NodeType, keyPath: KeyPath) => {\n  return (\n    (nodeTypeLoc === 'Object' || nodeTypeLoc === 'Array') &&\n    !isLogLineField(keyPath[0].toString()) &&\n    keyPath[0] !== JSONVizRootName &&\n    !isNumber(keyPath[0])\n  );\n};\n\nconst isTimestampNode = (keyPath: KeyPath) => {\n  return keyPath[1] === JSONVizRootName;\n};\n","import React from 'react';\n\nimport { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { LinkButton, useStyles2 } from '@grafana/ui';\n\nimport { logger } from 'services/logger';\nimport { narrowJsonDerivedFieldLinkPayload } from 'services/narrowing';\n\nfunction JSONLinkNodeButton({ payload }: { payload: string }) {\n  const styles = useStyles2(getStyles);\n  let decodedPayload;\n  try {\n    decodedPayload = JSON.parse(payload);\n  } catch (e) {\n    logger.error(e, { msg: 'Unable to parse JsonLinkButton payload!' });\n  }\n\n  const decodedPayloadNarrowed = narrowJsonDerivedFieldLinkPayload(decodedPayload);\n  if (decodedPayloadNarrowed) {\n    return (\n      <LinkButton\n        className={styles.button}\n        icon={'external-link-alt'}\n        variant={'secondary'}\n        size={'sm'}\n        fill={'text'}\n        href={decodedPayloadNarrowed.href}\n        target={'_blank'}\n      >\n        {decodedPayloadNarrowed.name}\n      </LinkButton>\n    );\n  }\n\n  return null;\n}\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    button: css({\n      '&:hover': {\n        color: theme.colors.primary.text,\n      },\n    }),\n  };\n};\n\nexport default JSONLinkNodeButton;\n","// Synced with https://github.com/grafana/grafana/blob/ca730935733d86339177ed5d014b9343831df98b/public/app/features/logs/components/panel/grammar.ts\n/* eslint-disable sort/object-properties */\nexport const logsSyntaxMatches: Record<string, RegExp> = {\n  // Levels regex\n  'log-token-critical': /(\\b)(CRITICAL|CRIT)($|\\s)/gi,\n  'log-token-error': /(\\b)(ERROR|ERR)($|\\s)/gi,\n  'log-token-warning': /(\\b|\\B)(WARNING|WARN)($|\\s)/gi,\n  'log-token-debug': /(\\b)(DEBUG)($|\\s)/gi,\n  'log-token-info': /(\\b|\\B)(INFO)($|\\s)/gi,\n  'log-token-trace': /(\\b)(TRACE)($|\\s)/gi,\n\n  // Misc log markup regex\n  'log-token-uuid': /(\\b|\\B)[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}/g,\n  'log-token-method': /\\b(GET|POST|PUT|DELETE|PATCH|HEAD|OPTIONS|TRACE|CONNECT)\\b/gi,\n  'log-token-key': /(\\b|\\B)[\\w_]+(?=\\s*=)/gi,\n  'log-token-size': /(?:\\b|\")\\d+\\.{0,1}\\d*\\s*[kKmMGgtTPp]*[bB]{1}(?:\"|\\b)/g,\n  'log-token-duration': /\\b\\d+(\\.\\d+)?(ns|s|ms|s|m|h|d)\\b/g,\n};\n","import React from 'react';\n\nimport { AdHocFilterWithLabels } from '@grafana/scenes';\n\nimport {\n  JSONHighlightLineFilterMatches,\n  JSONHighlightRegexMatches,\n} from '../../../services/JSONHighlightLineFilterMatches';\nimport { JSONDataFrameLinksName, JSONLogsScene } from '../JSONLogsScene';\nimport JSONLinkNodeButton from './JSONLinkNodeButton';\nimport { KeyPath } from '@gtk-grafana/react-json-tree/dist/types';\nimport { hasFieldParentNode, isTimeLabelNode } from 'services/JSONVizNodes';\nimport { logsSyntaxMatches } from 'services/logsSyntaxMatches';\n\ninterface ValueRendererProps {\n  keyPath: KeyPath;\n  lineFilters: AdHocFilterWithLabels[];\n  model: JSONLogsScene;\n  // @todo react-json-tree should probably return this type as string?\n  valueAsString: unknown;\n}\n\nexport default function ValueRenderer({ keyPath, lineFilters, valueAsString, model }: ValueRendererProps) {\n  if (isTimeLabelNode(keyPath)) {\n    return null;\n  }\n  const value = valueAsString?.toString();\n\n  // Don't bother rendering empty values\n  if (!value) {\n    return null;\n  }\n\n  // Link nodes\n  if (keyPath[1] === JSONDataFrameLinksName) {\n    return <JSONLinkNodeButton payload={value} />;\n  }\n\n  // If highlighting is enabled, split up the value string into an array of React objects wrapping text that matches syntax regex or matches line filter regex\n  if (model.state.hasHighlight) {\n    // Don't show line filter matches on field nodes\n    if (!hasFieldParentNode(keyPath)) {\n      let valueArray = JSONHighlightLineFilterMatches(lineFilters, value);\n\n      // If we have highlight matches we won't show syntax highlighting\n      if (valueArray.length) {\n        return valueArray;\n      }\n    }\n\n    // Check syntax highlighting results\n    let highlightedResults: Array<string | React.JSX.Element> = [];\n\n    // Only grab the first regex match from the logsSyntaxMatches object\n    Object.keys(logsSyntaxMatches).some((key) => {\n      const regex = value.match(logsSyntaxMatches[key]);\n      if (regex) {\n        highlightedResults = JSONHighlightRegexMatches([logsSyntaxMatches[key]], value, key);\n        return true;\n      }\n\n      return false;\n    });\n\n    if (highlightedResults.length) {\n      return highlightedResults;\n    }\n  }\n\n  return value;\n}\n","import React, { memo, useMemo } from 'react';\n\nimport { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { AdHocFilterWithLabels, SceneObject } from '@grafana/scenes';\nimport { Tooltip, useStyles2 } from '@grafana/ui';\n\nimport { addToFilters } from '../Breakdowns/AddToFiltersButton';\nimport { JSON_VIZ_LINE_HEIGHT } from './LogsJSONComponent';\nimport { FilterOp } from 'services/filterTypes';\nimport { logsLabelLevelsMatches } from 'services/panel';\nimport { LEVEL_VARIABLE_VALUE, VAR_LEVELS } from 'services/variables';\n\nfunction LineItemType({\n  detectedLevel,\n  sceneRef,\n  levelsVarFilters,\n}: {\n  detectedLevel: string;\n  levelsVarFilters: AdHocFilterWithLabels[];\n  sceneRef: SceneObject;\n}) {\n  const styles = useStyles2(getStyles);\n  const levelClass = Object.keys(logsLabelLevelsMatches).find((className) =>\n    detectedLevel.match(logsLabelLevelsMatches[className])\n  );\n  const existingFilter = levelsVarFilters.some(\n    (filter) => filter.value === detectedLevel && filter.operator === FilterOp.Equal\n  );\n\n  return useMemo(\n    () => (\n      <Tooltip\n        content={t(\n          'logs.json.line.detectedLevel.toggleButton',\n          existingFilter ? `Remove ${detectedLevel} filter` : `Include logs with ${detectedLevel} level`\n        )}\n      >\n        <button\n          onClick={(e) => {\n            e.stopPropagation();\n            addToFilters(LEVEL_VARIABLE_VALUE, detectedLevel, 'toggle', sceneRef, VAR_LEVELS);\n          }}\n          className={`${levelClass} ${styles.levelButtonStyles}`}\n        >\n          {detectedLevel.toUpperCase()}\n        </button>\n      </Tooltip>\n    ),\n    [existingFilter, detectedLevel, levelClass, sceneRef, styles.levelButtonStyles]\n  );\n}\n\nexport const JSONLineItemType = memo(LineItemType);\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    levelButtonStyles: css({\n      height: JSON_VIZ_LINE_HEIGHT,\n      marginLeft: '12px',\n      fontFamily: theme.typography.fontFamilyMonospace,\n      appearance: 'none',\n      background: 'none',\n      border: 'none',\n      fontSize: '0.9em',\n      // Keep button padding from pushing text further than other item string\n      padding: theme.spacing(0, 0.5, 0, 0.5),\n      '&:hover, &:focus': {\n        background: theme.colors.background.elevated,\n      },\n    }),\n  };\n};\n","import React, { useEffect, useRef } from 'react';\n\nimport { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { t } from '@grafana/i18n';\nimport { InlineToast, useStyles2 } from '@grafana/ui';\n\nimport ImgButton from '../UI/ImgButton';\n\nconst SHOW_SUCCESS_DURATION = 2 * 1000;\nconst COPY_TO_CLIPBOARD_TEXT = t('logs.log-line-details.copy-to-clipboard', 'Copy to clipboard');\nconst COPY_LINK_TO_LINE_TEXT = t('logs.log-line-menu.copy-link', 'Copy link to log line');\nconst COPY_LINK_ERROR_TEXT = t('logs.log-line-details.copy-to-clipboard-error', 'Error copying link!');\nconst COPY_SUCCESS = t('clipboard-button.inline-toast.success', 'Copied');\n\nexport default function CopyToClipboardButton({\n  onClick,\n  stopPropagation = true,\n  type = 'copy',\n}: {\n  onClick: () => void;\n  stopPropagation?: boolean;\n  type?: 'copy' | 'share-alt';\n}) {\n  const defaultText = type === 'copy' ? COPY_TO_CLIPBOARD_TEXT : COPY_LINK_TO_LINE_TEXT;\n  const [copied, setCopied] = React.useState(false);\n  const [copiedText, setCopiedText] = React.useState(COPY_SUCCESS);\n  const buttonRef = useRef<null | HTMLButtonElement>(null);\n  const styles = useStyles2(getStyles);\n\n  useEffect(() => {\n    let timeoutId: ReturnType<typeof setTimeout>;\n\n    if (copied) {\n      timeoutId = setTimeout(() => {\n        setCopied(false);\n      }, SHOW_SUCCESS_DURATION);\n    }\n\n    return () => {\n      window.clearTimeout(timeoutId);\n    };\n  }, [copied]);\n\n  return (\n    <>\n      {copied && (\n        <InlineToast placement=\"top\" referenceElement={buttonRef.current}>\n          {copiedText}\n        </InlineToast>\n      )}\n      <ImgButton\n        className={styles}\n        aria-pressed={copied}\n        tooltip={copied ? '' : defaultText}\n        name={type}\n        ref={buttonRef}\n        onClick={(e) => {\n          if (stopPropagation) {\n            // If the user clicked on the button, don't trigger the node to expand/collapse\n            e.stopPropagation();\n          }\n          try {\n            onClick();\n            setCopiedText(COPY_SUCCESS);\n          } catch (e) {\n            setCopiedText(COPY_LINK_ERROR_TEXT);\n          }\n          setCopied(true);\n        }}\n        tabIndex={0}\n      />\n    </>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return css({\n    color: theme.colors.text.secondary,\n  });\n};\n","import React from 'react';\n\nimport { isNumber } from 'lodash';\n\nimport { DataFrame, Field, TimeRange } from '@grafana/data';\nimport { SceneDataProvider, sceneGraph } from '@grafana/scenes';\n\nimport { isLogLineField, isLogsIdField } from '../../../services/fields';\nimport { logger } from '../../../services/logger';\nimport { copyText, generateLogShortlink } from '../../../services/text';\nimport CopyToClipboardButton from '../../Buttons/CopyToClipboardButton';\nimport { JSONLogsScene } from '../JSONLogsScene';\nimport { getLogsPanelFrame } from '../ServiceScene';\nimport { KeyPath } from '@gtk-grafana/react-json-tree/dist/types';\n\ninterface Props {\n  keyPath: KeyPath;\n  model: JSONLogsScene;\n}\nexport function JSONLogLineActionButtons({ model, keyPath }: Props) {\n  const timeRange = sceneGraph.getTimeRange(model).state.value;\n  return (\n    <>\n      <CopyToClipboardButton onClick={() => copyLogLine(keyPath, sceneGraph.getData(model))} />\n      <CopyToClipboardButton\n        type={'share-alt'}\n        onClick={() => getLinkToLog(keyPath, timeRange, model.state.rawFrame)}\n      />\n    </>\n  );\n}\n\nconst copyLogLine = (keyPath: KeyPath, $data: SceneDataProvider) => {\n  const logLineIndex = keyPath[0];\n  const dataFrame = getLogsPanelFrame($data.state.data);\n  const lineField = dataFrame?.fields.find((f) => isLogLineField(f.name));\n  if (isNumber(logLineIndex) && lineField) {\n    const line = lineField.values[logLineIndex];\n    copyText(line.toString());\n  }\n};\n\nfunction getLinkToLog(keyPath: KeyPath, timeRange: TimeRange, rawFrame: DataFrame | undefined) {\n  const idField: Field<string> | undefined = rawFrame?.fields.find((f) => isLogsIdField(f.name));\n  const logLineIndex = keyPath[0];\n  if (!isNumber(logLineIndex)) {\n    const error = Error('Invalid line index');\n    logger.error(error, { msg: 'Error getting log line index' });\n    throw error;\n  }\n  const logId = idField?.values[logLineIndex];\n  const logLineLink = generateLogShortlink('selectedLine', { id: logId, row: logLineIndex }, timeRange);\n  copyText(logLineLink);\n}\n","import React from 'react';\n\nimport { css } from '@emotion/css';\n\nimport { Field, FieldType, GrafanaTheme2, Labels } from '@grafana/data';\nimport { AdHocFiltersVariable } from '@grafana/scenes';\nimport { Icon, useStyles2 } from '@grafana/ui';\n\nimport { isLabelsField } from '../../../services/fields';\nimport { rootNodeItemString } from '../../../services/JSONViz';\nimport { hasProp } from '../../../services/narrowing';\nimport { LEVEL_VARIABLE_VALUE } from '../../../services/variables';\nimport {\n  JSONDataFrameLineName,\n  JSONDataFrameLinksName,\n  JSONDataFrameTimeName,\n  JSONLogsScene,\n  JSONVizRootName,\n} from '../JSONLogsScene';\nimport { JSONLineItemType } from './JSONLineItemType';\nimport { JSONLogLineActionButtons } from './JSONLogLineActionButtons';\nimport { KeyPath } from '@gtk-grafana/react-json-tree/dist/types';\n\ninterface ItemStringProps {\n  data: unknown;\n  itemString: string;\n  itemType: React.ReactNode;\n  keyPath: KeyPath;\n  levelsVar: AdHocFiltersVariable;\n  model: JSONLogsScene;\n  nodeType: string;\n}\n\nexport default function ItemString({ data, itemString, itemType, keyPath, model, levelsVar }: ItemStringProps) {\n  const styles = useStyles2(getStyles);\n  if (data && hasProp(data, JSONDataFrameTimeName) && typeof data.Time === 'string') {\n    return <JSONLogLineActionButtons keyPath={keyPath} model={model} />;\n  }\n\n  // The root node, which is visualized as the breadcrumb navigation\n  if (keyPath[0] === JSONVizRootName) {\n    return (\n      <span className={rootNodeItemString}>\n        {itemType} {itemString}\n      </span>\n    );\n  }\n\n  // log line nodes render the log level as the \"ItemString\"\n  if (keyPath[0] === JSONDataFrameLineName) {\n    const detectedLevel = getJsonDetectedLevel(model, keyPath);\n\n    if (detectedLevel) {\n      return (\n        <JSONLineItemType sceneRef={model} detectedLevel={detectedLevel} levelsVarFilters={levelsVar.state.filters} />\n      );\n    }\n  }\n\n  // Link nodes render the link icon\n  if (keyPath[0] === JSONDataFrameLinksName) {\n    return (\n      <span className={styles.wrapper}>\n        <Icon size={'sm'} name={'link'} />\n      </span>\n    );\n  }\n\n  // All other nodes return the itemType string from the library, e.g. [], {}\n  return <span className={styles.wrapper}>{itemType}</span>;\n}\n\nconst getJsonDetectedLevel = (model: JSONLogsScene, keyPath: KeyPath) => {\n  const labelsField: Field<Labels> | undefined = model.state.rawFrame?.fields.find(\n    (f) => f.type === FieldType.other && isLabelsField(f.name)\n  );\n  const index = typeof keyPath[1] === 'number' ? keyPath[1] : undefined;\n  const labels = index !== undefined ? labelsField?.values[index] : undefined;\n  return labels?.[LEVEL_VARIABLE_VALUE];\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    color: theme.colors.emphasize(theme.colors.text.secondary, 0.33),\n    display: 'inline-flex',\n    alignItems: 'center',\n    height: '22px',\n  }),\n});\n","(function(){\"use strict\";try{if(typeof document<\"u\"){var e=document.createElement(\"style\");e.appendChild(document.createTextNode(\"._arrowContainer_xqmcg_1{display:var(--json-tree-inline-flex);margin-right:var(--json-tree-arrow-container-margin-right)}._arrow_xqmcg_1{transition:var(--json-tree-arrow-transition);transform-origin:var(--json-tree-arrow-transform-origin);display:var(--json-tree-inline-flex);color:var(--json-tree-arrow-color);position:var(--json-tree-arrow-position);left:var(--json-tree-arrow-left-offset);margin-right:var(--json-tree-arrow-right-margin);top:0}._arrow--expanded_xqmcg_16{transform:var(--json-tree-arrow-transform)}._arrowInner_xqmcg_19{position:var(--json-tree-arrow-position);left:calc(var(--json-tree-arrow-width) / 3 * -1)}._itemRange_ed7dq_1{position:relative;display:var(--json-tree-inline)}._nestedNode_j6j98_1{display:var(--json-tree-inline-flex);position:relative;cursor:default}._nestedNode--expandable_j6j98_6{align-items:var(--json-tree-align-items);display:var(--json-tree-block);cursor:pointer}._nestedNode--expanded_j6j98_11{display:var(--json-tree-inline)}._nestedNode--itemType_j6j98_14{margin-right:var(--json-tree-nested-node-item-type-margin)}._nestedNode--itemType--expanded_j6j98_17{display:var(--json-tree-inline)}._nestedNodeLabelWrap_j6j98_21{display:var(--json-tree-block);align-items:var(--json-tree-align-items)}._nestedNodeItemString_j6j98_26{display:var(--json-tree-inline-flex)}._nestedNodeChildren_j6j98_30{display:var(--json-tree-block);flex-direction:var(--json-tree-flex-direction);margin-left:var(--json-tree-children-margin);padding:var(--json-tree-ul-padding)}._nestedNodeLabel_j6j98_21{display:var(--json-tree-inline-flex);align-items:var(--json-tree-align-items);margin-right:var(--json-tree-nested-node-label-margin);cursor:default}._nestedNodeLabel--expandable_j6j98_43{display:var(--json-tree-inline-flex);align-items:var(--json-tree-align-items);cursor:pointer}._nestedNodeLabel--expanded_j6j98_48{display:var(--json-tree-inline-flex)}._rootNode_j6j98_52{display:var(--json-tree-inline-flex);cursor:default}._rootNodeExpandable_j6j98_57{cursor:pointer}._rootNodeChildren_j6j98_61{display:var(--json-tree-block);flex-direction:var(--json-tree-flex-direction);padding:var(--json-tree-ul-root-children-padding)}._nodeListItemScrolled_18ya2_1{scroll-margin:var(--json-tree-scroll-margin)}._valueNode_1b1pr_1{display:var(--json-tree-block);align-items:var(--json-tree-value-node-align-items);cursor:default}._valueNodeValue_1b1pr_7{text-wrap:var(--json-tree-value-text-wrap);word-break:var(--json-tree-value-text-word-break);color:var(--json-tree-label-value-color)}._valueNodeLabel_1b1pr_13{margin-right:var(--json-tree-value-label-margin);display:var(--json-tree-inline-flex)}._valueNodeScrolled_1b1pr_18{scroll-margin:var(--json-tree-scroll-margin)}:root{--json-tree-spacing-sm: .25em;--json-tree-spacing-md: .5em;--json-tree-spacing-lg: 1em;--json-tree-spacing-xl: 1.5em;--json-tree-spacing-xxl: 2em;--json-tree-children-margin: var(--json-tree-spacing-xl);--json-tree-value-label-margin: var(--json-tree-spacing-sm);--json-tree-value-node-margin: var(--json-tree-spacing-xl);--json-tree-nested-node-label-margin: var(--json-tree-spacing-md);--json-tree-nested-node-item-type-margin: var(--json-tree-spacing-sm);--json-tree-default-label-wrap-margin-right: var(--json-tree-spacing-md);--json-tree-arrow-container-margin-right: 0;--json-tree-ul-root-padding: 0 0 0 var(--json-tree-spacing-xxl);--json-tree-ul-root-children-padding: 0;--json-tree-ul-padding: 0;--json-tree-value-text-wrap: wrap;--json-tree-value-text-word-break: break-word;--json-tree-inline: inline-grid;--json-tree-inline-flex: inline-flex;--json-tree-block: flex;--json-tree-align-items: center;--json-tree-value-node-align-items: flex-start;--json-tree-flex-direction: column;--json-tree-arrow-transition: var(--json-tree-transition-timing) linear transform;--json-tree-arrow-transform-origin: 45% 50%;--json-tree-arrow-transform: rotateZ(90deg);--json-tree-arrow-width: 1.5em;--json-tree-arrow-height: 1.5em;--json-tree-arrow-position: absolute;--json-tree-arrow-left-offset: calc(var(--json-tree-arrow-width) * -1);--json-tree-arrow-right-margin: 0;--json-tree-label-color: rgb(102, 217, 239);--json-tree-key-label-color: rgb(71, 131, 0);--json-tree-label-value-color: rgb(249, 38, 114);--json-tree-arrow-color: var(--json-tree-label-color);--json-tree-transition-timing: .15s;--json-tree-scroll-margin: 0}._tree_ze97d_48{padding:var(--json-tree-ul-root-padding)}._defaultItemString_ze97d_52{display:var(--json-tree-inline-flex);color:var(--json-tree-key-label-color)}._defaultLabelWrap_ze97d_57{display:var(--json-tree-inline-flex);margin-right:var(--json-tree-default-label-wrap-margin-right);color:var(--json-tree-label-color);cursor:default}._defaultLabelWrap--expandable_ze97d_63{cursor:pointer}\")),document.head.appendChild(e)}}catch(r){console.error(\"vite-plugin-css-injected-by-js\",r)}})();\nimport { jsxs as g, jsx as c } from \"react/jsx-runtime\";\nimport S, { useState as M, useCallback as J, createElement as w } from \"react\";\nfunction K(e) {\n  const t = Object.prototype.toString.call(e).slice(8, -1);\n  return t === \"Object\" && typeof e[Symbol.iterator] == \"function\" ? \"Iterable\" : t === \"Custom\" && e.constructor !== Object && e instanceof Object ? \"Object\" : t;\n}\nconst U = \"_arrow_xqmcg_1\", H = \"_arrow--expanded_xqmcg_16\", Q = \"_arrowInner_xqmcg_19\", x = {\n  arrow: U,\n  arrowExpanded: H,\n  arrowInner: Q\n};\nfunction P({\n  arrowStyle: e = \"single\",\n  expanded: t,\n  onClick: n\n}) {\n  return /* @__PURE__ */ g(\n    \"div\",\n    {\n      role: \"button\",\n      \"aria-expanded\": t,\n      tabIndex: 0,\n      onClick: n,\n      onKeyDown: (a) => {\n        (a.key === \"Enter\" || a.key === \" \") && (a.preventDefault(), n());\n      },\n      className: `${x.arrow} ${t ? x.arrowExpanded : \"\"} ${e === \"single\" ? x.arrowArrowStyleSingle : x.arrowArrowStyleDouble}`,\n      children: [\n        \"\",\n        e === \"double\" && /* @__PURE__ */ c(\"div\", { className: `${x.arrowInner}`, children: \"\" })\n      ]\n    }\n  );\n}\nfunction X(e, t) {\n  return e === \"Object\" ? Object.keys(t).length : e === \"Array\" ? t.length : 1 / 0;\n}\nfunction Y(e) {\n  return typeof e.set == \"function\";\n}\nfunction Z(e, t, n, a = 0, r = 1 / 0) {\n  let s;\n  if (e === \"Object\") {\n    let o = Object.getOwnPropertyNames(t);\n    n && o.sort(n === !0 ? void 0 : n), o = o.slice(a, r + 1), s = {\n      entries: o.map((l) => ({ key: l, value: t[l] }))\n    };\n  } else if (e === \"Array\")\n    s = {\n      entries: t.slice(a, r + 1).map((o, l) => ({ key: l + a, value: o }))\n    };\n  else {\n    let o = 0;\n    const l = [];\n    let i = !0;\n    const N = Y(t);\n    for (const d of t) {\n      if (o > r) {\n        i = !1;\n        break;\n      }\n      a <= o && (N && Array.isArray(d) ? typeof d[0] == \"string\" || typeof d[0] == \"number\" ? l.push({ key: d[0], value: d[1] }) : l.push({\n        key: `[entry ${o}]`,\n        value: {\n          \"[key]\": d[0],\n          \"[value]\": d[1]\n        }\n      }) : l.push({ key: o, value: d })), o++;\n    }\n    s = {\n      hasMore: !i,\n      entries: l\n    };\n  }\n  return s;\n}\nfunction L(e, t, n) {\n  const a = [];\n  for (; t - e > n * n; )\n    n = n * n;\n  for (let r = e; r <= t; r += n)\n    a.push({ from: r, to: Math.min(t, r + n - 1) });\n  return a;\n}\nfunction ee(e, t, n, a, r = 0, s = 1 / 0) {\n  const o = Z.bind(\n    null,\n    e,\n    t,\n    n\n  );\n  if (!a)\n    return o().entries;\n  const l = s < 1 / 0, i = Math.min(s - r, X(e, t));\n  if (e !== \"Iterable\") {\n    if (i <= a || a < 7)\n      return o(r, s).entries;\n  } else if (i <= a && !l)\n    return o(r, s).entries;\n  let N;\n  if (e === \"Iterable\") {\n    const { hasMore: d, entries: u } = o(r, r + a - 1);\n    N = d ? [...u, ...L(r + a, r + 2 * a - 1, a)] : u;\n  } else\n    N = l ? L(r, s, a) : [\n      ...o(0, a - 5).entries,\n      ...L(a - 4, i - 5, a),\n      ...o(i - 4, i - 1).entries\n    ];\n  return N;\n}\nconst te = \"_itemRange_ed7dq_1\", R = {\n  itemRange: te\n};\nfunction ne(e) {\n  const { from: t, to: n, renderChildNodes: a, nodeType: r, scrollToPath: s, keyPath: o } = e;\n  let l = !1;\n  if (s) {\n    const [u] = s;\n    k(s.slice(o.length * -1), o) && u > t && u <= n && (l = !0);\n  }\n  const [i, N] = M(l), d = J(() => {\n    N(!i);\n  }, [i]);\n  return i ? /* @__PURE__ */ c(\"div\", { className: `${R.itemRange}`, children: a(e, t, n) }) : /* @__PURE__ */ g(\"div\", { className: `${R.itemRange}`, children: [\n    /* @__PURE__ */ c(\n      P,\n      {\n        nodeType: r,\n        expanded: !1,\n        onClick: d,\n        arrowStyle: \"double\"\n      }\n    ),\n    `${t} ... ${n}`\n  ] });\n}\nconst ae = \"_nestedNode_j6j98_1\", re = \"_nestedNode--expandable_j6j98_6\", oe = \"_nestedNode--expanded_j6j98_11\", de = \"_nestedNode--itemType_j6j98_14\", se = \"_nestedNode--itemType--expanded_j6j98_17\", le = \"_nestedNodeLabelWrap_j6j98_21\", ce = \"_nestedNodeItemString_j6j98_26\", ie = \"_nestedNodeChildren_j6j98_30\", ue = \"_nestedNodeLabel_j6j98_21\", Ne = \"_nestedNodeLabel--expandable_j6j98_43\", pe = \"_nestedNodeLabel--expanded_j6j98_48\", fe = \"_rootNode_j6j98_52\", be = \"_rootNodeExpandable_j6j98_57\", _e = \"_rootNodeChildren_j6j98_61\", b = {\n  nestedNode: ae,\n  nestedNodeExpandable: re,\n  nestedNodeExpanded: oe,\n  nestedNodeItemType: de,\n  nestedNodeItemTypeExpanded: se,\n  nestedNodeLabelWrap: le,\n  nestedNodeItemString: ce,\n  nestedNodeChildren: ie,\n  nestedNodeLabel: ue,\n  nestedNodeLabelExpandable: Ne,\n  nestedNodeLabelExpanded: pe,\n  rootNode: fe,\n  rootNodeExpandable: be,\n  rootNodeChildren: _e\n}, he = \"_nodeListItemScrolled_18ya2_1\", ye = {\n  nodeListItemScrolled: he\n}, W = ({\n  children: e,\n  expanded: t,\n  expandable: n,\n  nodeType: a,\n  keyPath: r,\n  className: s,\n  scrollToPath: o\n}) => {\n  const l = S.useRef(null), i = o !== void 0 && k(o, r);\n  S.useEffect(() => {\n    l.current && l.current.scrollIntoView({ behavior: \"auto\" });\n  }, []);\n  const N = i ? { ref: l, \"data-scrolled\": \"true\" } : {};\n  return n ? /* @__PURE__ */ c(\n    \"li\",\n    {\n      role: \"treeitem\",\n      \"aria-expanded\": t,\n      \"data-nodetype\": a,\n      \"data-keypath\": r[0],\n      \"aria-label\": r[0]?.toString(),\n      className: `${s} ${i ? ye.nodeListItemScrolled : \"\"}`,\n      ...N,\n      children: e\n    }\n  ) : /* @__PURE__ */ c(\n    \"li\",\n    {\n      role: \"treeitem\",\n      \"data-nodetype\": a,\n      \"data-keypath\": r[0],\n      \"aria-label\": r[0]?.toString(),\n      className: s,\n      ...N,\n      children: e\n    }\n  );\n};\nfunction ge(e) {\n  return e.to !== void 0;\n}\nfunction V(e, t, n) {\n  const {\n    nodeType: a,\n    data: r,\n    collectionLimit: s,\n    circularCache: o,\n    keyPath: l,\n    postprocessValue: i,\n    sortObjectKeys: N,\n    scrollToPath: d\n  } = e, u = [];\n  return ee(\n    a,\n    r,\n    N,\n    s,\n    t,\n    n\n  ).forEach((f) => {\n    if (ge(f))\n      u.push(\n        /* @__PURE__ */ w(\n          ne,\n          {\n            ...e,\n            key: `ItemRange--${f.from}-${f.to}`,\n            from: f.from,\n            to: f.to,\n            renderChildNodes: V,\n            scrollToPath: d\n          }\n        )\n      );\n    else {\n      const { key: p, value: m } = f, E = o.includes(m);\n      u.push(\n        /* @__PURE__ */ w(\n          z,\n          {\n            ...e,\n            postprocessValue: i,\n            collectionLimit: s,\n            key: `Node--${p}`,\n            keyPath: [p, ...l],\n            value: i(m),\n            circularCache: [...o, m],\n            isCircular: E,\n            hideRoot: !1\n          }\n        )\n      );\n    }\n  }), u;\n}\nfunction C(e) {\n  const {\n    circularCache: t = [],\n    collectionLimit: n,\n    createItemString: a,\n    data: r,\n    expandable: s,\n    getItemString: o,\n    hideRoot: l,\n    hideRootExpand: i,\n    isCircular: N,\n    keyPath: d,\n    labelRenderer: u,\n    level: f = 0,\n    nodeType: p,\n    nodeTypeIndicator: m,\n    shouldExpandNodeInitially: E,\n    scrollToPath: O\n  } = e, G = d[0] === \"root\", T = i ? s && !G && i : s, y = s && T, [_, q] = M(\n    // calculate individual node expansion if necessary\n    N ? !1 : E(d, r, f)\n  ), j = J(() => {\n    y && q(!_);\n  }, [y, _]), v = _ || l && f === 0 ? V({ ...e, circularCache: t, level: f + 1 }) : null, D = /* @__PURE__ */ c(\n    \"span\",\n    {\n      className: `${b.nestedNodeItemType} ${_ ? b.nestedNodeItemTypeExpanded : \"\"}`,\n      children: m\n    }\n  ), B = o(\n    p,\n    r,\n    D,\n    a(r, n),\n    d\n  ), F = [d, p, _, y];\n  return l ? /* @__PURE__ */ c(\n    W,\n    {\n      scrollToPath: O,\n      expandable: y,\n      expanded: _,\n      nodeType: p,\n      keyPath: d,\n      className: `${b.rootNode} ${_ ? b.rootNodeExpanded : \"\"} ${s ? b.rootNodeExpandable : \"\"}`,\n      children: /* @__PURE__ */ c(\"ul\", { className: `${b.rootNodeChildren}`, children: v })\n    }\n  ) : /* @__PURE__ */ g(\n    W,\n    {\n      scrollToPath: O,\n      expandable: y,\n      expanded: _,\n      nodeType: p,\n      keyPath: d,\n      className: `${b.nestedNode}  ${_ ? b.nestedNodeExpanded : \"\"} ${y ? b.nestedNodeExpandable : \"\"}`,\n      children: [\n        /* @__PURE__ */ g(\"span\", { className: b.nestedNodeLabelWrap, children: [\n          T && /* @__PURE__ */ c(\n            P,\n            {\n              nodeType: p,\n              expanded: _,\n              onClick: j\n            }\n          ),\n          /* @__PURE__ */ c(\n            \"span\",\n            {\n              \"data-nodetype\": p,\n              \"data-keypath\": d[0],\n              className: `${b.nestedNodeLabel} ${_ ? b.nestedNodeLabelExpanded : \"\"} ${y ? b.nestedNodeLabelExpandable : \"\"}`,\n              onClick: j,\n              children: u(...F)\n            }\n          ),\n          /* @__PURE__ */ c(\"span\", { className: b.nestedNodeItemString, onClick: j, children: B })\n        ] }),\n        v && /* @__PURE__ */ c(\"ul\", { className: b.nestedNodeChildren, children: v })\n      ]\n    }\n  );\n}\nfunction me(e) {\n  const t = Object.getOwnPropertyNames(e).length;\n  return `${t} ${t !== 1 ? \"keys\" : \"key\"}`;\n}\nfunction xe({ data: e, ...t }) {\n  return /* @__PURE__ */ c(\n    C,\n    {\n      ...t,\n      data: e,\n      nodeType: \"Object\",\n      nodeTypeIndicator: t.nodeType === \"Error\" ? \"Error()\" : \"{}\",\n      createItemString: me,\n      expandable: Object.getOwnPropertyNames(e).length > 0\n    }\n  );\n}\nfunction Ie(e) {\n  return `${e.length} ${e.length !== 1 ? \"items\" : \"item\"}`;\n}\nfunction Se({ data: e, ...t }) {\n  return /* @__PURE__ */ c(\n    C,\n    {\n      ...t,\n      data: e,\n      nodeType: \"Array\",\n      nodeTypeIndicator: \"[]\",\n      createItemString: Ie,\n      expandable: e.length > 0\n    }\n  );\n}\nfunction $e(e, t) {\n  let n = 0, a = !1;\n  if (Number.isSafeInteger(e.size))\n    n = e.size;\n  else\n    for (const r of e) {\n      if (t && n + 1 > t) {\n        a = !0;\n        break;\n      }\n      n += 1;\n    }\n  return `${a ? \">\" : \"\"}${n} ${n !== 1 ? \"entries\" : \"entry\"}`;\n}\nfunction Ee(e) {\n  return /* @__PURE__ */ c(\n    C,\n    {\n      ...e,\n      nodeType: \"Iterable\",\n      nodeTypeIndicator: \"()\",\n      createItemString: $e,\n      expandable: !0\n    }\n  );\n}\nconst je = \"_valueNode_1b1pr_1\", ve = \"_valueNodeValue_1b1pr_7\", Le = \"_valueNodeLabel_1b1pr_13\", we = \"_valueNodeScrolled_1b1pr_18\", I = {\n  valueNode: je,\n  valueNodeValue: ve,\n  valueNodeLabel: Le,\n  valueNodeScrolled: we\n};\nfunction h({\n  nodeType: e,\n  labelRenderer: t,\n  keyPath: n,\n  valueRenderer: a,\n  value: r,\n  valueGetter: s = (l) => l,\n  scrollToPath: o\n}) {\n  const l = S.useRef(null), i = o !== void 0 && k(o, n);\n  S.useEffect(() => {\n    l.current && l.current.scrollIntoView({ behavior: \"auto\" });\n  }, []);\n  const N = i ? { ref: l, \"data-scrolled\": \"true\" } : {};\n  return /* @__PURE__ */ g(\n    \"li\",\n    {\n      className: `${I.valueNode} valueNode--${e} valueNode--${n[0]} ${i ? I.valueNodeScrolled : \"\"}`,\n      ...N,\n      children: [\n        /* @__PURE__ */ c(\"span\", { className: I.valueNodeLabel, children: t(n, e, !1, !1) }),\n        /* @__PURE__ */ c(\"span\", { className: I.valueNodeValue, children: a(\n          s ? s(r) : void 0,\n          r,\n          ...n\n        ) })\n      ]\n    }\n  );\n}\nfunction z({\n  getItemString: e,\n  keyPath: t,\n  labelRenderer: n,\n  value: a,\n  valueRenderer: r,\n  isCustomNode: s,\n  valueWrap: o,\n  scrollToPath: l,\n  ...i\n}) {\n  const N = s(a) ? \"Custom\" : K(a), d = t[0], u = {\n    keyPath: t,\n    labelRenderer: n,\n    nodeType: N,\n    value: a,\n    valueRenderer: r,\n    scrollToPath: l\n  }, f = {\n    ...i,\n    ...u,\n    getItemString: e,\n    data: a,\n    isCustomNode: s,\n    valueWrap: o\n  };\n  switch (N) {\n    case \"Object\":\n    case \"Error\":\n    case \"WeakMap\":\n    case \"WeakSet\":\n      return /* @__PURE__ */ c(xe, { ...f }, d);\n    case \"Array\":\n      return /* @__PURE__ */ c(Se, { ...f }, d);\n    case \"Iterable\":\n    case \"Map\":\n    case \"Set\":\n      return /* @__PURE__ */ c(Ee, { ...f }, d);\n    case \"String\":\n      return /* @__PURE__ */ w(\n        h,\n        {\n          ...u,\n          key: d,\n          valueGetter: (p) => `${o}${p}${o}`\n        }\n      );\n    case \"Number\":\n      return /* @__PURE__ */ c(h, { ...u }, d);\n    case \"Boolean\":\n      return /* @__PURE__ */ c(\n        h,\n        {\n          ...u,\n          valueGetter: (p) => p ? \"true\" : \"false\"\n        },\n        d\n      );\n    case \"Date\":\n      return /* @__PURE__ */ c(\n        h,\n        {\n          ...u,\n          valueGetter: (p) => p.toISOString()\n        },\n        d\n      );\n    case \"Null\":\n      return /* @__PURE__ */ c(\n        h,\n        {\n          ...u,\n          valueGetter: () => \"null\"\n        },\n        d\n      );\n    case \"Undefined\":\n      return /* @__PURE__ */ c(\n        h,\n        {\n          ...u,\n          valueGetter: () => \"undefined\"\n        },\n        d\n      );\n    case \"Function\":\n    case \"Symbol\":\n      return /* @__PURE__ */ c(\n        h,\n        {\n          ...u,\n          valueGetter: (p) => p.toString()\n        },\n        d\n      );\n    case \"Custom\":\n      return /* @__PURE__ */ c(h, { ...u }, d);\n    default:\n      return /* @__PURE__ */ c(\n        h,\n        {\n          ...u,\n          valueGetter: () => `<${N}>`\n        },\n        d\n      );\n  }\n}\nconst Ce = \"_tree_ze97d_48\", ke = \"_defaultItemString_ze97d_52\", Oe = \"_defaultLabelWrap_ze97d_57\", Te = \"_defaultLabelWrap--expandable_ze97d_63\", $ = {\n  tree: Ce,\n  defaultItemString: ke,\n  defaultLabelWrap: Oe,\n  defaultLabelWrapExpandable: Te\n}, A = (e) => e, Re = (e, t, n) => n === 0, We = (e, t, n, a) => /* @__PURE__ */ g(\"span\", { className: $.defaultItemString, children: [\n  n,\n  \" \",\n  a\n] }), Ae = ([e], t, n, a) => /* @__PURE__ */ g(\n  \"span\",\n  {\n    className: `${$.defaultLabelWrap} ${a ? $.defaultLabelWrapExpandable : \"\"}`,\n    children: [\n      e,\n      \":\"\n    ]\n  }\n), Me = () => !1;\nfunction Ve({\n  data: e,\n  keyPath: t = [\"root\"],\n  labelRenderer: n = Ae,\n  valueRenderer: a = A,\n  shouldExpandNodeInitially: r = Re,\n  hideRoot: s = !1,\n  hideRootExpand: o = !1,\n  getItemString: l = We,\n  postprocessValue: i = A,\n  isCustomNode: N = Me,\n  collectionLimit: d = 50,\n  sortObjectKeys: u = !1,\n  scrollToPath: f,\n  valueWrap: p = '\"'\n}) {\n  return /* @__PURE__ */ c(\n    \"ul\",\n    {\n      role: \"tree\",\n      \"aria-multiselectable\": !0,\n      \"aria-readonly\": \"true\",\n      className: $.tree,\n      children: /* @__PURE__ */ c(\n        z,\n        {\n          scrollToPath: f,\n          hideRootExpand: o,\n          keyPath: s ? [] : t,\n          value: i(e),\n          isCustomNode: N,\n          labelRenderer: n,\n          valueRenderer: a,\n          shouldExpandNodeInitially: r,\n          hideRoot: s,\n          getItemString: l,\n          postprocessValue: i,\n          collectionLimit: d,\n          sortObjectKeys: u,\n          valueWrap: p\n        }\n      )\n    }\n  );\n}\nconst k = (e, t) => {\n  if (!e.length || e.length !== t.length)\n    return !1;\n  for (let n = 0; n < e.length; n++)\n    if (e[n] !== t[n])\n      return !1;\n  return !0;\n};\nexport {\n  Ve as JSONTree,\n  k as areKeyPathsEqual\n};\n","import React, { useCallback, useMemo, useRef } from 'react';\n\nimport { css } from '@emotion/css';\n\nimport { colorManipulator, FieldType, GrafanaTheme2 } from '@grafana/data';\nimport { AdHocFilterWithLabels, SceneComponentProps, sceneGraph } from '@grafana/scenes';\nimport { Alert, PanelChrome, useStyles2 } from '@grafana/ui';\n\nimport { NoMatchingLabelsScene } from '../Breakdowns/NoMatchingLabelsScene';\nimport { JSONLogsScene, JSONVizRootName } from '../JSONLogsScene';\nimport LabelRenderer from '../JSONPanel/LabelRenderer';\nimport ValueRenderer from '../JSONPanel/ValueRenderer';\nimport { LogListControls } from '../LogListControls';\nimport { LogsListScene } from '../LogsListScene';\nimport { LogsPanelError } from '../LogsPanelError';\nimport { getLogsPanelFrame } from '../ServiceScene';\nimport ItemString from './ItemString';\nimport { JSONTree } from '@gtk-grafana/react-json-tree';\nimport { ScrollToPath } from '@gtk-grafana/react-json-tree/dist/types';\nimport { LogsPanelHeaderActions } from 'Components/Table/LogsHeaderActions';\nimport { isLogLineField, isLogsIdField } from 'services/fields';\nimport { getLogsHighlightStyles } from 'services/highlight';\nimport {\n  setJSONHighlightVisibility,\n  setJSONLabelsVisibility,\n  setJSONMetadataVisibility,\n  setLogOption,\n} from 'services/store';\nimport {\n  getFieldsVariable,\n  getJSONFieldsVariable,\n  getLevelsVariable,\n  getLineFiltersVariable,\n} from 'services/variableGetters';\nimport { clearVariables } from 'services/variableHelpers';\n\nexport const JSON_VIZ_LINE_HEIGHT = '24px';\n\nexport default function LogsJSONComponent({ model }: SceneComponentProps<JSONLogsScene>) {\n  const {\n    canClearFilters,\n    emptyScene,\n    error,\n    errorType,\n    hasJSONFields,\n    JSONFiltersSupported,\n    menu,\n    hasHighlight,\n    hasLabels,\n    hasMetadata,\n    sortOrder,\n    wrapLogMessage,\n    data,\n    rawFrame,\n  } = model.useState();\n  // Rerender on data change\n  const $data = sceneGraph.getData(model);\n  $data.useState();\n\n  const logsListScene = sceneGraph.getAncestor(model, LogsListScene);\n  const { visualizationType, selectedLine } = logsListScene.useState();\n  const styles = useStyles2(getStyles, wrapLogMessage);\n\n  const fieldsVar = getFieldsVariable(model);\n  const JSONVariable = getJSONFieldsVariable(model);\n  const levelsVar = getLevelsVariable(model);\n\n  // If we have a line format variable, we are drilled down into a nested node\n  const dataFrame = getLogsPanelFrame(data);\n  const lineField = dataFrame?.fields.find((field) => field.type === FieldType.string && isLogLineField(field.name));\n  const JSONParserPropsMap = new Map<string, AdHocFilterWithLabels>();\n  const lineFilterVar = getLineFiltersVariable(model);\n\n  const scrollToPath: ScrollToPath | undefined = useMemo(() => {\n    if (selectedLine === undefined) {\n      return undefined;\n    }\n    const idField = rawFrame?.fields.find((field) => isLogsIdField(field.name));\n    const lineIndex = idField?.values.findIndex((v) => v === selectedLine?.id);\n    const cleanLineIndex = lineIndex !== undefined && lineIndex !== -1 ? lineIndex : undefined;\n    return cleanLineIndex !== undefined ? [cleanLineIndex, JSONVizRootName] : undefined;\n  }, [selectedLine, rawFrame]);\n\n  JSONVariable.state.filters.forEach((filter) => {\n    // @todo this should probably be set in the AdHocFilterWithLabels valueLabels array\n    // all json props are wrapped with [\\\" ... \"\\], strip those chars out so we have the actual key used in the json\n    const fullKeyFromJSONParserProps = filter.value\n      .substring(3, filter.value.length - 3)\n      .split('\\\\\"][\\\\\"')\n      .join('_');\n    JSONParserPropsMap.set(fullKeyFromJSONParserProps, filter);\n  });\n  const scrollRef = useRef<HTMLDivElement | null>(null);\n\n  const onScrollToBottomClick = useCallback(() => {\n    scrollRef.current?.scrollTo(0, scrollRef.current.scrollHeight);\n  }, []);\n\n  const onScrollToTopClick = useCallback(() => {\n    scrollRef.current?.scrollTo(0, 0);\n  }, []);\n\n  const onToggleStructuredMetadataClick = useCallback(\n    (visible: boolean) => {\n      model.setState({ hasMetadata: visible });\n      setJSONMetadataVisibility(visible);\n    },\n    [model]\n  );\n\n  const onToggleLabelsClick = useCallback(\n    (visible: boolean) => {\n      model.setState({ hasLabels: visible });\n      setJSONLabelsVisibility(visible);\n    },\n    [model]\n  );\n\n  const onToggleHighlightClick = useCallback(\n    (visible: boolean) => {\n      model.setState({ hasHighlight: visible });\n      setJSONHighlightVisibility(visible);\n    },\n    [model]\n  );\n\n  const onWrapLogMessageClick = useCallback(\n    (wrap: boolean) => {\n      model.setState({ wrapLogMessage: wrap });\n      setLogOption('wrapLogMessage', wrap);\n    },\n    [model]\n  );\n\n  const showNoJSONDetected = lineField && lineField.values.length > 0 && hasJSONFields === false;\n  const showLokiNotSupported = !JSONFiltersSupported && showNoJSONDetected !== true;\n  const controlsExpanded = logsListScene.state.controlsExpanded;\n\n  return (\n    <div className={styles.panelChromeWrap}>\n      {!error && (\n        <>\n          {/* @ts-expect-error todo: fix this when https://github.com/grafana/grafana/issues/103486 is done*/}\n          <PanelChrome\n            padding={'none'}\n            showMenuAlways={true}\n            statusMessage={$data.state.data?.errors?.[0].message}\n            loadingState={$data.state.data?.state}\n            title={'JSON'}\n            menu={menu ? <menu.Component model={menu} /> : undefined}\n            actions={\n              <LogsPanelHeaderActions vizType={visualizationType} onChange={logsListScene.setVisualizationType} />\n            }\n          >\n            <div className={styles.container}>\n              {lineField?.values && lineField?.values.length > 0 && (\n                <LogListControls\n                  controlsExpanded={controlsExpanded}\n                  onExpandControlsClick={() => {\n                    logsListScene.setState({ controlsExpanded: !controlsExpanded });\n                    setLogOption('controlsExpanded', !controlsExpanded);\n                  }}\n                  onWrapLogMessageClick={onWrapLogMessageClick}\n                  wrapLogMessage={wrapLogMessage}\n                  showHighlight={hasHighlight}\n                  onToggleHighlightClick={onToggleHighlightClick}\n                  showMetadata={hasMetadata}\n                  onToggleStructuredMetadataClick={onToggleStructuredMetadataClick}\n                  showLabels={hasLabels}\n                  onToggleLabelsClick={onToggleLabelsClick}\n                  sortOrder={sortOrder}\n                  onSortOrderChange={model.handleSortChange}\n                  onScrollToBottomClick={onScrollToBottomClick}\n                  onScrollToTopClick={onScrollToTopClick}\n                />\n              )}\n              {lineField?.values && lineField?.values.length > 0 && (\n                <div className={styles.JSONTreeWrap} ref={scrollRef}>\n                  {showLokiNotSupported && (\n                    <Alert className={styles.alert} severity={'warning'} title={'JSON filtering requires Loki 3.5.0.'}>\n                      This view will be read only until Loki is upgraded to 3.5.0\n                    </Alert>\n                  )}\n                  {showNoJSONDetected && (\n                    <Alert className={styles.alert} severity={'info'} title={'No JSON fields detected'}>\n                      This view is built for JSON log lines, but none were detected. Switch to the Logs or Table view\n                      for a better experience.\n                    </Alert>\n                  )}\n                  <JSONTree\n                    scrollToPath={scrollToPath}\n                    data={lineField.values}\n                    hideRootExpand={true}\n                    valueWrap={''}\n                    shouldExpandNodeInitially={(_, __, level) => level <= 2}\n                    // Render item type string, e.g. (), {}\n                    getItemString={(nodeType, data, itemType, itemString, keyPath) => (\n                      <ItemString\n                        itemString={itemString}\n                        keyPath={keyPath}\n                        itemType={itemType}\n                        data={data}\n                        nodeType={nodeType}\n                        model={model}\n                        levelsVar={levelsVar}\n                      />\n                    )}\n                    // Render node values\n                    valueRenderer={(valueAsString, _, ...keyPath) => (\n                      <ValueRenderer\n                        valueAsString={valueAsString}\n                        keyPath={keyPath}\n                        lineFilters={lineFilterVar.state.filters}\n                        model={model}\n                      />\n                    )}\n                    // Render node labels\n                    labelRenderer={(keyPath, nodeType) => (\n                      <LabelRenderer\n                        model={model}\n                        nodeType={nodeType}\n                        keyPath={keyPath}\n                        fieldsVar={fieldsVar}\n                        lineField={lineField}\n                        JSONFiltersSupported={JSONFiltersSupported}\n                        JSONParserPropsMap={JSONParserPropsMap}\n                        lineFilters={lineFilterVar.state.filters}\n                      />\n                    )}\n                  />\n                </div>\n              )}\n              {emptyScene && lineField?.values.length === 0 && <NoMatchingLabelsScene.Component model={emptyScene} />}\n            </div>\n          </PanelChrome>\n        </>\n      )}\n      {error && (\n        <LogsPanelError\n          error={error}\n          errorType={errorType}\n          clearFilters={canClearFilters ? () => clearVariables(model) : undefined}\n          sceneRef={model}\n        />\n      )}\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2, wrapLogMessage: boolean) => {\n  const hoverBg = theme.isDark\n    ? colorManipulator.alpha(colorManipulator.lighten(theme.colors.background.canvas, 0.1), 0.4)\n    : colorManipulator.alpha(colorManipulator.darken(theme.colors.background.canvas, 0.1), 0.4);\n\n  const selectedBg = theme.isDark\n    ? colorManipulator.darken(colorManipulator.alpha(theme.colors.info.transparent, 1), 0.2)\n    : colorManipulator.lighten(colorManipulator.alpha(theme.colors.info.transparent, 1), 0.2);\n\n  return {\n    alert: css({\n      marginTop: theme.spacing(3.5),\n      marginBottom: 0,\n    }),\n    panelChromeWrap: css({\n      // Required to keep content from pushing out of page wrapper when the grafana menu is docked\n      contain: 'strict',\n      width: '100%',\n      height: '100%',\n    }),\n    container: css({\n      display: 'flex',\n      flexDirection: 'row-reverse',\n      height: '100%',\n      paddingBottom: theme.spacing(1),\n      paddingRight: theme.spacing(1),\n      ...getLogsHighlightStyles(theme),\n      contain: 'content',\n    }),\n    highlight: css({\n      backgroundColor: 'rgb(255, 153, 0)',\n      color: 'black',\n    }),\n\n    JSONTreeWrap: css`\n      font-family: ${theme.typography.fontFamilyMonospace};\n      font-family: ${theme.typography.fontFamilyMonospace}; // override css variables\n      --json-tree-align-items: flex-start;\n      --json-tree-label-color: ${theme.colors.text.primary};\n      --json-tree-label-value-color: ${theme.colors.text.secondary};\n      --json-tree-arrow-color: ${theme.colors.secondary.contrastText};\n      --json-tree-ul-root-padding: ${theme.spacing(3)} 0 ${theme.spacing(2)} 0;\n      --json-tree-arrow-left-offset: -${theme.spacing(2)};\n      --json-tree-inline: inline-grid;\n      --json-tree-value-label-margin: 1em;\n      // Scroll offset for sticky header\n      --json-tree-scroll-margin: 26px;\n      // Scroll behavior @todo set \"auto\" instead of \"smooth\" for users with prefers-reduced-motion\n      scroll-behavior: ${window.matchMedia('(prefers-reduced-motion: reduce)').matches ? 'auto' : 'smooth'};\n      ${getWrapLogMessageStyles(theme, wrapLogMessage)}\n\n      overflow: auto;\n      height: 100%;\n      width: 100%;\n      // Prevents scrollbar from getting tucked behind the fixed header\n      clip-path: inset(0 0 0 0);\n\n      // Line height defines the height of each line\n      li {\n        line-height: ${JSON_VIZ_LINE_HEIGHT};\n      }\n\n      //first treeItem node\n      > ul > li {\n        // line wrap\n        width: 100%;\n        margin-top: ${theme.spacing(2.5)};\n      }\n\n      // Array and other labels additional without markup\n      // first nested node padding\n      > ul > li > ul {\n        // Hackery to keep elements from under the sticky header from being in the scrollable area\n        padding: 0 0 0 ${theme.spacing(2)};\n      }\n\n      // Root node styles\n      > ul > li > span {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: calc(100% - ${theme.spacing(4.75)});\n        background: ${theme.colors.background.primary};\n        padding-bottom: ${theme.spacing(0.5)};\n        margin-bottom: ${theme.spacing(0.5)};\n        box-shadow: 0 1px 7px rgba(1, 4, 9, 0.75);\n        z-index: 2;\n        padding-left: ${theme.spacing(1)};\n        align-items: center;\n        overflow-x: auto;\n        overflow-y: hidden;\n      }\n\n      // Line node scrolledTo styles\n      li[data-scrolled='true'] {\n        // sticky header cannot have transparency!\n        & > span {\n          background-color: ${selectedBg};\n        }\n        background-color: ${colorManipulator.alpha(theme.colors.info.transparent, 0.25)};\n      }\n\n      // Value node background hover colors\n      .valueNode--String,\n      .valueNode--Number {\n        &:hover {\n          // This is the value line the user is hovering over, we don't want transparency so it always stands out from the bg\n          background-color: ${theme.colors.background.canvas};\n          box-shadow: ${theme.shadows.z1};\n        }\n      }\n\n      // Nested node hover styles\n      ul > li > ul > li > ul {\n        li[data-nodetype='Object'],\n        li[data-nodetype='Array'] {\n          // This is the nested node line the user is hovering over, we don't want transparency so it always stands out from the bg\n          & > span {\n            width: 100%;\n            &:hover {\n              background-color: ${theme.colors.background.canvas};\n              box-shadow: ${theme.shadows.z1};\n            }\n          }\n          // And this is the node the user is hovering in, we want some transparency to help differentiate between nodes of differing depths\n          &:hover {\n            background-color: ${hoverBg};\n            box-shadow: ${theme.shadows.z1};\n          }\n        }\n      }\n\n      // sticky time header\n      > ul > li > ul > li > span,\n      > ul > li > ul > div > li > span {\n        position: sticky;\n        width: 100%;\n        top: 26px;\n        left: 0;\n        background: ${theme.colors.background.primary};\n        z-index: 1;\n        display: flex;\n        align-items: center;\n        &:hover {\n          background-color: ${theme.colors.background.canvas};\n          box-shadow: ${theme.shadows.z1};\n        }\n      }\n    `,\n  };\n};\n\nconst getWrapLogMessageStyles = (theme: GrafanaTheme2, wrapLogMessage: boolean) => {\n  if (!wrapLogMessage) {\n    return css`\n      // line wrap\n      --json-tree-value-text-wrap: nowrap;\n    `;\n  }\n\n  return undefined;\n};\n","import * as React from 'react';\nimport { useMemo } from 'react';\n\nimport { css, cx } from '@emotion/css';\n\nimport { colorManipulator, GrafanaTheme2 } from '@grafana/data';\nimport { PopoverContent, Tooltip, useStyles2 } from '@grafana/ui';\n\n// Dark theme\nimport copyDark from 'img/icons/dark/copy.svg';\nimport copyHoverDark from 'img/icons/dark/copy--hover.svg';\nimport eyeDark from 'img/icons/dark/eye.svg';\nimport eyeHoverDark from 'img/icons/dark/eye--hover.svg';\nimport searchMinusDark from 'img/icons/dark/search-minus.svg';\nimport searchMinusHoverDark from 'img/icons/dark/search-minus--hover.svg';\nimport searchPlusDark from 'img/icons/dark/search-plus.svg';\nimport searchPlusHoverDark from 'img/icons/dark/search-plus--hover.svg';\nimport shareAltDark from 'img/icons/dark/share-alt.svg';\nimport shareAltHoverDark from 'img/icons/dark/share-alt--hover.svg';\nimport eyeActive from 'img/icons/eye--active.svg';\n// Light theme\nimport copyLight from 'img/icons/light/copy.svg';\nimport copyHoverLight from 'img/icons/light/copy--hover.svg';\nimport eyeLight from 'img/icons/light/eye.svg';\nimport eyeHoverLight from 'img/icons/light/eye--hover.svg';\nimport searchMinusLight from 'img/icons/light/search-minus.svg';\nimport searchMinusHoverLight from 'img/icons/light/search-minus--hover.svg';\nimport searchPlusLight from 'img/icons/light/search-plus.svg';\nimport searchPlusHoverLight from 'img/icons/light/search-plus--hover.svg';\nimport shareAltLight from 'img/icons/light/share-alt.svg';\nimport shareAltHoverLight from 'img/icons/light/share-alt--hover.svg';\nimport searchMinusActive from 'img/icons/search-minus--active.svg';\nimport searchPlusActive from 'img/icons/search-plus--active.svg';\n\ntype ThemeVariant = 'dark' | 'light';\ntype IconButtonVariant = 'primary' | 'secondary';\ntype IconName = 'copy' | 'eye' | 'search-minus' | 'search-plus' | 'share-alt';\n\ninterface BaseProps extends Omit<React.ButtonHTMLAttributes<HTMLButtonElement>, 'aria-label'> {\n  /** Name of the icon **/\n  name: IconName;\n  /** Variant to change the color of the Icon */\n  variant?: IconButtonVariant;\n}\n\nexport interface BasePropsWithTooltip extends BaseProps {\n  /** Tooltip content to display on hover and as the aria-label */\n  tooltip: PopoverContent;\n}\n\ntype Images = Record<IconName, Record<ThemeVariant, Record<IconButtonVariant | 'hover', string>>>;\n\nconst images: Images = {\n  eye: {\n    dark: {\n      secondary: eyeDark,\n      primary: eyeActive,\n      hover: eyeHoverDark,\n    },\n    light: {\n      secondary: eyeLight,\n      primary: eyeActive,\n      hover: eyeHoverLight,\n    },\n  },\n  'search-minus': {\n    dark: {\n      secondary: searchMinusDark,\n      primary: searchMinusActive,\n      hover: searchMinusHoverDark,\n    },\n    light: {\n      secondary: searchMinusLight,\n      primary: searchMinusActive,\n      hover: searchMinusHoverLight,\n    },\n  },\n  'search-plus': {\n    dark: {\n      secondary: searchPlusDark,\n      primary: searchPlusActive,\n      hover: searchPlusHoverDark,\n    },\n    light: {\n      secondary: searchPlusLight,\n      primary: searchPlusActive,\n      hover: searchPlusHoverLight,\n    },\n  },\n  'share-alt': {\n    dark: {\n      secondary: shareAltDark,\n      hover: shareAltHoverDark,\n      // Unused\n      primary: '',\n    },\n    light: {\n      secondary: shareAltLight,\n      hover: shareAltHoverLight,\n      // Unused\n      primary: '',\n    },\n  },\n  copy: {\n    dark: {\n      secondary: copyDark,\n      hover: copyHoverDark,\n      // Unused\n      primary: '',\n    },\n    light: {\n      secondary: copyLight,\n      hover: copyHoverLight,\n      // Unused\n      primary: '',\n    },\n  },\n};\n\nconst ImgButton = React.forwardRef<HTMLButtonElement, BasePropsWithTooltip>((props, ref) => {\n  const { variant = 'secondary', name, className, tooltip, ...restProps } = props;\n\n  const styles = useStyles2(getStyles, variant, name, images);\n\n  let ariaLabel: string | undefined;\n  let buttonRef: typeof ref | undefined;\n  ariaLabel = typeof tooltip === 'string' ? tooltip : undefined;\n\n  // When using tooltip, ref is forwarded to Tooltip component instead for https://github.com/grafana/grafana/issues/65632\n  return useMemo(\n    () => (\n      <Tooltip ref={ref} content={tooltip}>\n        <button\n          {...restProps}\n          ref={buttonRef}\n          aria-label={ariaLabel}\n          className={cx(styles.button, className)}\n          type=\"button\"\n        >\n          <span className={styles.img}></span>\n        </button>\n      </Tooltip>\n    ),\n    [ariaLabel, ref, className, restProps, styles, tooltip, buttonRef]\n  );\n});\nImgButton.displayName = 'ImgButton';\nexport default ImgButton;\n\nconst getStyles = (theme: GrafanaTheme2, variant: IconButtonVariant, name: IconName, images: Images) => {\n  let iconColor = theme.colors.text.primary;\n\n  if (variant === 'primary') {\n    iconColor = theme.colors.primary.text;\n  }\n\n  const themeType = theme.isDark ? 'dark' : 'light';\n\n  return {\n    button: css({\n      zIndex: 0,\n      position: 'relative',\n      margin: `0 ${theme.spacing.x0_5} 0 0`,\n      boxShadow: 'none',\n      border: 'none',\n      display: 'inline-flex',\n      background: 'transparent',\n      justifyContent: 'center',\n      alignItems: 'center',\n      padding: 0,\n      color: iconColor,\n\n      '&[disabled], &:disabled': {\n        cursor: 'not-allowed',\n        color: theme.colors.action.disabledText,\n        opacity: 0.65,\n      },\n\n      '&:focus, &:focus-visible': {\n        outline: '2px dotted transparent',\n        outlineOffset: '2px',\n        boxShadow: `0 0 0 2px ${theme.colors.background.canvas}, 0 0 0px 4px ${theme.colors.primary.main}`,\n        transitionTimingFunction: `cubic-bezier(0.19, 1, 0.22, 1)`,\n        transitionDuration: '0.2s',\n        transitionProperty: 'outline, outline-offset, box-shadow',\n      },\n\n      '&:focus:not(:focus-visible)': {\n        outline: 'none',\n        boxShadow: `none`,\n      },\n    }),\n    icon: css({\n      verticalAlign: 'baseline',\n    }),\n    img: css({\n      backgroundImage:\n        variant === 'primary' ? `url(${images[name][themeType].primary})` : `url(${images[name][themeType].secondary})`,\n      width: '16px',\n      height: '16px',\n\n      '&:before': {\n        width: '16px',\n        height: '16px',\n        left: 0,\n        zIndex: -1,\n        position: 'absolute',\n        opacity: 0,\n        borderRadius: theme.shape.radius.default,\n        content: '\"\"',\n        transform: 'scale(1.45)',\n        [theme.transitions.handleMotion('no-preference', 'reduce')]: {\n          transitionDuration: '0.2s',\n          transitionTimingFunction: 'cubic-bezier(0.4, 0, 0.2, 1)',\n          transitionProperty: 'opacity',\n        },\n      },\n\n      '&:hover': {\n        backgroundImage: `url(${images[name][themeType].hover})`,\n        '&:before': {\n          backgroundColor:\n            variant === 'secondary' ? theme.colors.action.hover : colorManipulator.alpha(iconColor, 0.12),\n          opacity: 1,\n        },\n      },\n    }),\n  };\n};\n"],"names":["getWrappingElement","className","jsxValues","span","mark","highlightValueStringMatches","matchingIntervals","value","size","valueArray","lineFilterMatchIndex","matchInterval","valueIndex","length","push","result","stringValues","i","char","mergeStringsAndElements","getMatchingIntervals","matchExpressions","results","forEach","regex","valueMatch","valueMatches","exec","e","logger","info","source","fromToArray","map","vm","index","mergeOverlapping","matchIndices","arr","sort","a","b","resIdx","Math","max","mergeOverlap","getLogsHighlightStyles","theme","colors","critical","debug","error","text","metadata","primary","parsedField","trace","warning","color","success","fontWeight","typography","fontWeightMedium","opacity","fontWeightBold","shade","JSONHighlightLineFilterMatches","lineFilters","filters","filter","search","operator","LineFilterOp","match","RegExp","key","f","getLineFilterRegExps","lineFilterMatches","JSONLabelText","keyPathString","styles","useStyles2","getJSONLabelWrapStyles","strong","JSONLabelWrapStyles","addJSONFieldFilter","keyPath","filterType","logsJsonScene","variableType","addCurrentUrlToHistory","replace","LABEL_NAME_INVALID_CHARS","addJsonParserFieldValue","logsListScene","sceneGraph","getAncestor","LogsListScene","addToFilters","reportAppInteraction","USER_EVENTS_PAGES","service_details","USER_EVENTS_ACTIONS","add_to_filters_in_json_panel","action","ImgButton","lazy","JSONNestedNodeFilterButton","active","fullKeyPath","type","getJSONFilterButtonStyles","useMemo","button","tooltip","onClick","stopPropagation","EMPTY_VARIABLE_VALUE","VAR_FIELDS","aria-selected","variant","name","aria-label","isActive","css","undefined","secondary","maxContrast","JSONFieldValueButton","memo","existingFilter","fullKey","label","model","FilterOp","Equal","NotEqual","selected","displayName","JSONMetadataButton","sceneRef","addJSONMetadataFilter","JSONLeafNodeLabelButtons","JSONMetadataButtons","toString","find","isOperatorInclusive","isOperatorExclusive","JSONRootNodeNavigation","getLineFormatVariable","state","rootKeyPath","JSONDataFrameLineName","JSONVizRootName","drillUpWrapperStyle","Button","setNewRootNode","fill","disabled","Icon","breadCrumbDelimiter","addDrillUp","itemStringDelimiter","getFullKeyPath","sceneObject","fullPathFilters","isLogLineField","reverse","nodeKey","LineFormatFilterOp","Empty","EMPTY_AD_HOC_FILTER_VALUE","slice","setState","lineFormatEvent","removeLineFormatFilters","clearJSONParserFields","change_line_format_in_json_panel","lineFormatVariable","JSONVar","getJSONFieldsVariable","fieldsVar","getFieldsVariable","lineFormatFilters","keyIndex","findIndex","lineFormatFiltersToKeep","_","JSONParserKeys","join","JSONParserKeysToRemove","fieldsFilterSet","Set","fieldFilter","add","JSONParserFilters","includes","has","isTimeLabelNode","JSONDataFrameTimeName","hasFieldParentNode","JSONDataFrameStructuredMetadataName","JSONDataFrameLabelsName","JSONLeafLabel","lineField","JSONParserPropsMap","JSONFiltersSupported","JSONLogsScene","getValue","keys","accessors","pop","getJSONVizNestedProperty","values","existingVariableType","LEVEL_VARIABLE_VALUE","VAR_LEVELS","VAR_METADATA","VAR_LABELS","getFilterVariableTypeFromPath","highlightedValue","hasHighlight","getAdHocFiltersVariable","labelButtonsWrap","getKeyPathString","getJSONKey","JSONParserProp","get","existingJSONFilter","getValueFromFieldsFilter","elements","ReRootJSONButton","NestedNodeFilterButtonsComponent","fieldsFilters","JSONNestedLabelWrapStyles","JSONParentNodeFilterButtons","LabelRenderer","nodeType","style","nodeTypeLoc","JSONStructuredMetadataDisplayName","JSONLabelsDisplayName","JSONDataFrameLinksName","JSONLinksDisplayName","isJSONLeafNode","isJSONParentNode","isTimestampNode","isNumber","time","JSONLabelWrapStylesPrimary","getStyles","payload","decodedPayload","JSON","parse","msg","decodedPayloadNarrowed","narrowJsonDerivedFieldLinkPayload","LinkButton","icon","href","target","logsSyntaxMatches","ValueRenderer","valueAsString","JSONLinkNodeButton","highlightedResults","Object","some","JSONHighlightRegexMatches","LineItemType","detectedLevel","levelsVarFilters","levelClass","logsLabelLevelsMatches","Tooltip","content","t","levelButtonStyles","toUpperCase","JSONLineItemType","height","JSON_VIZ_LINE_HEIGHT","marginLeft","fontFamily","fontFamilyMonospace","appearance","background","border","fontSize","padding","spacing","elevated","COPY_TO_CLIPBOARD_TEXT","COPY_LINK_TO_LINE_TEXT","COPY_LINK_ERROR_TEXT","COPY_SUCCESS","CopyToClipboardButton","defaultText","copied","setCopied","React","copiedText","setCopiedText","buttonRef","useRef","useEffect","timeoutId","setTimeout","window","clearTimeout","InlineToast","placement","referenceElement","current","aria-pressed","ref","tabIndex","JSONLogLineActionButtons","timeRange","getTimeRange","copyLogLine","getData","rawFrame","idField","fields","isLogsIdField","logLineIndex","Error","logId","logLineLink","generateLogShortlink","id","row","copyText","getLinkToLog","$data","dataFrame","getLogsPanelFrame","data","line","ItemString","itemString","itemType","levelsVar","hasProp","Time","rootNodeItemString","getJsonDetectedLevel","wrapper","labelsField","FieldType","other","isLabelsField","labels","emphasize","display","alignItems","document","createElement","appendChild","createTextNode","head","r","console","x","arrow","arrowExpanded","arrowInner","P","arrowStyle","expanded","n","role","onKeyDown","preventDefault","arrowArrowStyleSingle","arrowArrowStyleDouble","children","Z","s","o","getOwnPropertyNames","entries","l","N","set","Y","d","Array","isArray","hasMore","L","from","to","min","ee","bind","X","u","R","ne","renderChildNodes","scrollToPath","k","nestedNode","nestedNodeExpandable","nestedNodeExpanded","nestedNodeItemType","nestedNodeItemTypeExpanded","nestedNodeLabelWrap","nestedNodeItemString","nestedNodeChildren","nestedNodeLabel","nestedNodeLabelExpandable","nestedNodeLabelExpanded","rootNode","rootNodeExpandable","rootNodeChildren","ye","W","expandable","scrollIntoView","behavior","V","collectionLimit","circularCache","postprocessValue","sortObjectKeys","ge","p","m","E","z","isCircular","hideRoot","C","createItemString","getItemString","hideRootExpand","labelRenderer","level","nodeTypeIndicator","shouldExpandNodeInitially","O","G","T","y","q","j","v","B","F","rootNodeExpanded","me","xe","Ie","Se","$e","Number","isSafeInteger","Ee","I","h","valueRenderer","valueGetter","isCustomNode","valueWrap","prototype","call","Symbol","iterator","constructor","K","toISOString","$","A","Re","We","Ae","Me","Ve","LogsJSONComponent","canClearFilters","emptyScene","errorType","hasJSONFields","menu","hasLabels","hasMetadata","sortOrder","wrapLogMessage","useState","visualizationType","selectedLine","JSONVariable","getLevelsVariable","field","string","Map","lineFilterVar","getLineFiltersVariable","lineIndex","cleanLineIndex","fullKeyFromJSONParserProps","substring","split","scrollRef","onScrollToBottomClick","useCallback","scrollTo","scrollHeight","onScrollToTopClick","onToggleStructuredMetadataClick","visible","setJSONMetadataVisibility","onToggleLabelsClick","setJSONLabelsVisibility","onToggleHighlightClick","setJSONHighlightVisibility","onWrapLogMessageClick","wrap","setLogOption","showNoJSONDetected","showLokiNotSupported","controlsExpanded","div","panelChromeWrap","PanelChrome","showMenuAlways","statusMessage","errors","message","loadingState","title","Component","actions","LogsPanelHeaderActions","vizType","onChange","setVisualizationType","container","LogListControls","onExpandControlsClick","showHighlight","showMetadata","showLabels","onSortOrderChange","handleSortChange","JSONTreeWrap","Alert","alert","severity","JSONTree","__","NoMatchingLabelsScene","LogsPanelError","clearFilters","clearVariables","hoverBg","isDark","colorManipulator","alpha","lighten","canvas","darken","selectedBg","transparent","marginTop","marginBottom","contain","width","flexDirection","paddingBottom","paddingRight","highlight","backgroundColor","contrastText","matchMedia","matches","getWrapLogMessageStyles","shadows","z1","images","eye","dark","eyeDark","eyeActive","hover","eyeHoverDark","light","eyeLight","eyeHoverLight","searchMinusDark","searchMinusActive","searchMinusHoverDark","searchMinusLight","searchMinusHoverLight","searchPlusDark","searchPlusActive","searchPlusHoverDark","searchPlusLight","searchPlusHoverLight","shareAltDark","shareAltHoverDark","shareAltLight","shareAltHoverLight","copy","copyDark","copyHoverDark","copyLight","copyHoverLight","props","restProps","ariaLabel","cx","img","iconColor","themeType","zIndex","position","margin","x0_5","boxShadow","justifyContent","cursor","disabledText","outline","outlineOffset","main","transitionTimingFunction","transitionDuration","transitionProperty","verticalAlign","backgroundImage","left","borderRadius","shape","radius","default","transform","transitions","handleMotion"],"ignoreList":[],"sourceRoot":""}