# ðŸ§¹ Auditoria de Qualidade â€” Open Claw Bot (2026-02-18)

## Resumo
O repositÃ³rio tem **60 arquivos no src/** mas o Open Claw Bot usa efetivamente **~15 arquivos core**. O resto Ã© estrutura morta, diretÃ³rios vazios, e scripts experimentais.

---

## âœ… CORE â€” Manter (essencial para o bot funcionar)

### src/core/ (3 arquivos â€” TODOS essenciais)
| Arquivo | FunÃ§Ã£o | Qualidade |
|---|---|---|
| `telegram-bot.js` | Loop principal do bot | âœ… OK (refatorado com token-router) |
| `openclaw-bridge.mjs` | Bridge de intents + awareness | âœ… OK |
| `qdrant-memory.js` | MemÃ³ria semÃ¢ntica Qdrant | âœ… OK |

### src/jarvis/ (arquivos essenciais)
| Arquivo | FunÃ§Ã£o | Qualidade |
|---|---|---|
| `orchestrator.mjs` | Hub central de agentes | âœ… OK |
| `swarm-server.mjs` | API HTTP + dashboard | âœ… OK (com Bearer Token) |
| `ai/token-router.mjs` | Roteador de modelos | âœ… NOVO |
| `ai/semantic-cache.mjs` | Cache Redis | âœ… NOVO |
| `browser/openai-agent.mjs` | Engine LLM (Grok) | âœ… OK (refatorado) |
| `search/perplexity-search.mjs` | Busca Perplexity | âœ… OK (refatorado) |
| `security/input-sanitizer.mjs` | Anti-injection | âœ… OK |
| `security/rate-limiter.mjs` | Rate limiter | âœ… OK |
| `terminal/aider-bridge.mjs` | ExecuÃ§Ã£o terminal | âœ… OK |
| `vision/screen-capture.mjs` | Screenshots | âœ… OK |

### Infra essencial
| Arquivo | FunÃ§Ã£o | Qualidade |
|---|---|---|
| `.env` | Config principal | âœ… OK (limpo) |
| `.context/PERSONA.md` | Persona do bot | âœ… NOVO (Refrimix HVAC) |
| `infra/docker-compose.yml` | Qdrant + Redis | âœ… OK |
| `infra/systemd/*.service` | Autostart | âœ… OK |
| `package.json` | DependÃªncias | âœ… OK |

---

## âŒ PODA SEGURA â€” Remover (nÃ£o afeta o bot)

### DiretÃ³rios Vazios
- `src/jarvis/bridge/` â€” vazio
- `src/services/smoke-test-v1/` â€” vazio
- `tests/e2e_evidence/` â€” vazio
- `tests/integration/` â€” vazio
- `tests/smoke/` â€” vazio

### Arquivos/MÃ³dulos NÃ£o Usados pelo Bot
- `src/jarvis/browser/gemini-web.mjs` â€” Gemini Web foi substituÃ­do pelo OpenRouter
- `src/jarvis/browser/persistent-browser.mjs` â€” profile browser, nÃ£o usado
- `src/jarvis/mouse/xdotool-control.mjs` â€” controle de mouse, nÃ£o essencial
- `src/jarvis/scheduler/` â€” scheduler sem uso ativo
- `src/web-ui/dashboard/roadmap.html` â€” HTML estÃ¡tico obsoleto
- `src/web-ui/frontend/README.md` â€” placeholder vazio
- `src/web-ui/backend/` â€” duplica o que jÃ¡ estÃ¡ em src/backend

### Scripts Experimentais
- `scripts/ativar_modo_liberal.sh` â€” one-shot experimental
- `scripts/demo.mjs` â€” demo antigo
- `scripts/valida_openai.py` â€” Python teste avulso
- `scripts/tf-apply.sh` / `scripts/tf-plan.sh` â€” Terraform (nÃ£o usado)
- `scripts/install_ph01_master.sh` â€” instalaÃ§Ã£o one-shot antiga

### Infra Pesada (dados locais, nÃ£o cÃ³digo)
- `infra/mc` â€” binÃ¡rio MinIO client (30MB!)
- `infra/grafana_data/` â€” 233 arquivos de dados Grafana
- `infra/localstack_data/` â€” dados LocalStack
- `infra/minio_data/` â€” dados MinIO
- `infra/qdrant_data/` â€” dados Qdrant (manter se tiver memÃ³ria)

### Testes Duplicados/Antigos
- `tests/smoke-test-sovereign.mjs` â€” 8KB, teste antigo
- `tests/super-test.mjs` â€” teste genÃ©rico
- `tests/e2e-telegram-demo.mjs` â€” demo antigo
- `tests/playwright-e2e.mjs` â€” e2e desatualizado

---

## âš ï¸ Problemas de Qualidade Encontrados

### 1. PERSONA.md ~~era ~1.800 chars genÃ©rico~~ â†’ âœ… CORRIGIDO
Agora Ã© especialista VRV Daikin / Refrimix com funÃ§Ãµes CRM, agenda e marketing.

### 2. System Prompt ~~era 300 chars repetitivo~~ â†’ âœ… CORRIGIDO
MANDATO_SOBERANO comprimido de 300 para 60 chars no openai-agent.mjs.

### 3. .env ~~tinha 7x REDIS_URL duplicados~~ â†’ âœ… CORRIGIDO
Limpo com seÃ§Ãµes organizadas e variÃ¡veis de modelo Grok/Perplexity.

### 4. Redis senha ~~desconhecida~~ â†’ âš ï¸ PENDENTE
Redis requer auth mas sudo estava bloqueado. Script `setup-base.sh` resolve.

### 5. web-ui/ duplica backend/ â†’ ðŸŸ¡ Candidato para merge

### 6. infra/mc (MinIO binary 30MB) â†’ ðŸ”´ NÃ£o deveria estar no Git

---

## ðŸ“‹ Comando de Poda (executar quando aprovado)

```bash
# DiretÃ³rios vazios
rmdir src/jarvis/bridge src/services/smoke-test-v1 tests/e2e_evidence tests/integration tests/smoke 2>/dev/null

# Scripts experimentais
rm -f scripts/ativar_modo_liberal.sh scripts/demo.mjs scripts/valida_openai.py
rm -f scripts/tf-apply.sh scripts/tf-plan.sh scripts/install_ph01_master.sh

# Testes antigos
rm -f tests/smoke-test-sovereign.mjs tests/super-test.mjs tests/e2e-telegram-demo.mjs tests/playwright-e2e.mjs

# Web UI obsoleto
rm -f src/web-ui/dashboard/roadmap.html src/web-ui/frontend/README.md

# MinIO binary (30MB! nÃ£o Ã© cÃ³digo)
rm -f infra/mc

# Add to .gitignore
echo -e "\ninfra/grafana_data/\ninfra/localstack_data/\ninfra/minio_data/\ninfra/qdrant_data/" >> .gitignore
```
